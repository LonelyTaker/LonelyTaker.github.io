<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/image/site/favicon/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/image/site/favicon/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><link rel="apple-touch-icon" href="/image/site/favicon/favicon-180x180.png?v=2.6.2" sizes="180x180"><meta name="description" content="一.简介       webpack是一个构建工具，是一个静态模块打包器(module bundler)。                     二.Webpack五个核心概念                           1.Entry       入口，指示Webpack以哪个文件为入口起点开始打包，分析构建内部依赖图">
<meta property="og:type" content="article">
<meta property="og:title" content="webpack">
<meta property="og:url" content="https://lonelytaker.cn/2022/01/24/webpack/index.html">
<meta property="og:site_name" content="LonelyTaker&#39;s Blog">
<meta property="og:description" content="一.简介       webpack是一个构建工具，是一个静态模块打包器(module bundler)。                     二.Webpack五个核心概念                           1.Entry       入口，指示Webpack以哪个文件为入口起点开始打包，分析构建内部依赖图">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-01-24T02:09:12.000Z">
<meta property="article:modified_time" content="2022-02-22T13:36:56.067Z">
<meta property="article:author" content="LonelyTaker">
<meta property="article:tag" content="工具">
<meta name="twitter:card" content="summary"><title>webpack | LonelyTaker's Blog</title><link ref="canonical" href="https://lonelytaker.cn/2022/01/24/webpack/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":false,"scrollDownIcon":true},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"复制","copySuccess":"复制成功","copyError":"复制失败"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.0.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner header-inner--height header-inner--bgcolor"><nav class="header-nav header-nav--sticky"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">归档</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">分类</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">标签</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">webpack</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2022-01-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2022-02-22</span></span></div></header><div class="post-body">
        <h1 id="一-简介">
          <a href="#一-简介" class="heading-link"><i class="fas fa-link"></i></a><a href="#一-简介" class="headerlink" title="一.简介"></a>一.简介</h1>
      <p>webpack是一个构建工具，是一个静态模块打包器(module bundler)。</p>

        <h1 id="二-Webpack五个核心概念">
          <a href="#二-Webpack五个核心概念" class="heading-link"><i class="fas fa-link"></i></a><a href="#二-Webpack五个核心概念" class="headerlink" title="二.Webpack五个核心概念"></a>二.Webpack五个核心概念</h1>
      
        <h2 id="1-Entry">
          <a href="#1-Entry" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Entry" class="headerlink" title="1.Entry"></a>1.Entry</h2>
      <p>入口，指示Webpack以哪个文件为入口起点开始打包，分析构建内部依赖图</p>

        <h2 id="2-Output">
          <a href="#2-Output" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-Output" class="headerlink" title="2.Output"></a>2.Output</h2>
      <p>输出，指示Webpack打包后的资源bundles输出到哪里去，以及如何命名。</p>

        <h2 id="3-Loader">
          <a href="#3-Loader" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-Loader" class="headerlink" title="3.Loader"></a>3.Loader</h2>
      <p>Loader让Webpack能够去处理那些非JavaScript文件(webpack自身只能理解JavaScript)</p>

        <h2 id="4-Plugins">
          <a href="#4-Plugins" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-Plugins" class="headerlink" title="4.Plugins"></a>4.Plugins</h2>
      <p>插件可以用执行范围更广的任务。插件的范围包括：从打包优化和压缩，一直到重新定义环境中的变量等。</p>

        <h2 id="5-Mode">
          <a href="#5-Mode" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-Mode" class="headerlink" title="5.Mode"></a>5.Mode</h2>
      <p>模式指示Webpack使用相应模式的配置。</p>
<ul>
<li>development - 开发模式</li>
<li>production - 生产模式</li>
</ul>

        <h1 id="三-学习">
          <a href="#三-学习" class="heading-link"><i class="fas fa-link"></i></a><a href="#三-学习" class="headerlink" title="三.学习"></a>三.学习</h1>
      
        <h2 id="1-初体验">
          <a href="#1-初体验" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-初体验" class="headerlink" title="1.初体验"></a>1.初体验</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* webpack入口文件index.js */</span></span><br></pre></td></tr></table></div></figure>

<figure class="highlight shell"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">运行指令</span><br><span class="line">开发环境: webpack ./index.js -o ./build/built.js --mode=development</span><br><span class="line">	webpack会以index.js为入口文件开始打包，打包后输出到./build/built.js</span><br><span class="line">	整体打包环境是开发环境</span><br><span class="line">生产环境: webpack ./index.js -o ./build/built.js --mode=production</span><br></pre></td></tr></table></div></figure>

<p>结论：</p>
<ul>
<li>webpack可以处理js/json资源，不能处理css/img等其他资源</li>
<li>生产环境和开发环境能将ES6模块化编译成浏览器能识别的模块化</li>
<li>生产环境比开发环境多一个压缩js代码</li>
</ul>

        <h2 id="2-打包样式资源">
          <a href="#2-打包样式资源" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-打包样式资源" class="headerlink" title="2.打包样式资源"></a>2.打包样式资源</h2>
      <p>webpack.config.js，webpack的配置文件</p>
<p>模块化默认采用commonJS，因为所有构建工具都是基于Nodejs平台运行的</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// resolve用来拼接绝对路径的方法</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="comment">// 入口起点</span></span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="comment">// 输出</span></span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="comment">// 输出文件名</span></span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="comment">// 输出路径</span></span><br><span class="line">        <span class="comment">// __dirname代表当前文件目录的绝对路径</span></span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="comment">// loader的配置</span></span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">            <span class="comment">// 详细loader配置</span></span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="comment">// 匹配哪些文件</span></span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                <span class="comment">// 使用哪些loader进行处理</span></span><br><span class="line">                use:[</span><br><span class="line">                    <span class="comment">// use数组中loader执行顺序：从右到左(从下到上)依次执行</span></span><br><span class="line">                    <span class="comment">// 创建style标签，将js中的样式资源插入进行，添加到head中生效</span></span><br><span class="line">                    <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">                    <span class="comment">// 将css文件变成commonjs模块加载到js中，里面内容是样式字符串</span></span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.less$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">                    <span class="comment">// 将less文件编译成css文件</span></span><br><span class="line">                    <span class="string">&#x27;less-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="comment">// plugins的配置</span></span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        </span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 模式(development 或 production)</span></span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="3-打包html资源">
          <a href="#3-打包html资源" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-打包html资源" class="headerlink" title="3.打包html资源"></a>3.打包html资源</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	loader: 1.下载 2.使用(配置)</span></span><br><span class="line"><span class="comment">	plugins: 1.下载 2.引入 3.使用</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="comment">// loader的配置</span></span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="comment">// plugins的配置</span></span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="comment">// 默认会创建一个空的html，自动引入打包输出的所有资源(JS/CSS)</span></span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="comment">// 复制 &#x27;./src/index.html&#x27;文件，并自动引入打包输出的所有资源(JS/CSS)</span></span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 模式(development 或 production)</span></span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="4-打包图片资源">
          <a href="#4-打包图片资源" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-打包图片资源" class="headerlink" title="4.打包图片资源"></a>4.打包图片资源</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="comment">// loader的配置</span></span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;	</span><br><span class="line">                <span class="comment">// 问题：默认处理不了Html中的img图片</span></span><br><span class="line">                <span class="comment">// 处理图片资源</span></span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.(jpg|png|gif)$/</span>,</span><br><span class="line">                <span class="comment">// 只使用一个loader可以直接使用loader:&#x27;&#x27;</span></span><br><span class="line">                loader:<span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>:&#123;</span><br><span class="line">                    <span class="comment">// 图片大小小于8kb，就会被base64处理</span></span><br><span class="line">                    <span class="comment">// 优点:减少请求数量(减轻服务器压力)</span></span><br><span class="line">                    <span class="comment">// 缺点:图片体积会更大(文件请求速度更慢)</span></span><br><span class="line">                    <span class="attr">limit</span>:<span class="number">8</span>*<span class="number">1024</span>,</span><br><span class="line">                    <span class="comment">// 问题:因为url-loader默认使用es6模块化解析，而html-loader引入图片是commonjs，解析时会出问题</span></span><br><span class="line">                    <span class="comment">// 解决：关闭url-loader的es6模块化解析，使用commonjs解析</span></span><br><span class="line">                    <span class="attr">esModule</span>:<span class="literal">false</span>,</span><br><span class="line">                    <span class="comment">// 给图片重命名</span></span><br><span class="line">                    <span class="comment">// [hash:10]取图片hash的前10位</span></span><br><span class="line">                    <span class="comment">// [ext]取文件原来扩展名</span></span><br><span class="line">                    <span class="attr">name</span>:<span class="string">&#x27;[hash:10].[ext]&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.html$/</span>,</span><br><span class="line">                <span class="comment">// 处理Html文件的img图片(负责引入img,从而能够被url-loader进行处理)</span></span><br><span class="line">                loader:<span class="string">&#x27;html-loader&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="comment">// plugins的配置</span></span><br><span class="line">    <span class="attr">plugins</span>:[],</span><br><span class="line">    <span class="comment">// 模式(development 或 production)</span></span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="5-打包其他资源">
          <a href="#5-打包其他资源" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-打包其他资源" class="headerlink" title="5.打包其他资源"></a>5.打包其他资源</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// 打包其他资源(除了html/js/css资源以外的资源)</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 排除html/js/css资源以外的资源</span></span><br><span class="line">                <span class="attr">exclude</span>:<span class="regexp">/\.(css|js|html)$/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;file-loader&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>在<code>Webpack5</code>之前通常使用：</p>
<ul>
<li><code>raw-loader</code>将文件导入为字符串</li>
<li><code>url-loader</code>将文件作为data URI内联到bundle中</li>
<li><code>file-loader</code>将文件发送到输出目录</li>
</ul>
<p>而在<code>Webpack5</code>中使用4种新的模块类型来替代这些loader：</p>
<ul>
<li><code>asset/resource</code>：发送一个单独的文件并导出URL。之前使用<code>file-loader</code>实现</li>
<li><code>asset/inline</code>：导出一个资源的data URI。之前使用<code>url-loader</code>实现</li>
<li><code>asset/source</code>：导出资源的源代码。之前使用<code>raw-loader</code>实现</li>
<li><code>asset</code>：导出一个data URI和发送一个单独的文件之间自动选择。之前使用<code>url-loader</code>并配置资源体积限制实现</li>
</ul>
<p>例如：</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack5之前配置图片资源</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="attr">test</span>:<span class="regexp">/\.(jpg|png|gif)$/</span>,</span><br><span class="line">	loader:<span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">	<span class="attr">options</span>:&#123;</span><br><span class="line">		<span class="attr">limit</span>:<span class="number">8</span>*<span class="number">1024</span>,</span><br><span class="line">		<span class="attr">esModule</span>:<span class="literal">false</span>,</span><br><span class="line">		<span class="attr">name</span>:<span class="string">&#x27;[hash:10].[ext]&#x27;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// webpack5</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="attr">test</span>: <span class="regexp">/\.(png|svg)$/</span>,</span><br><span class="line">	type: <span class="string">&quot;asset&quot;</span>,</span><br><span class="line">	<span class="attr">generator</span>: &#123;</span><br><span class="line">		<span class="attr">filename</span>: <span class="string">&quot;[hash:10].[ext]&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">parser</span>:&#123;</span><br><span class="line">        <span class="attr">dataUrlCondition</span>:&#123;</span><br><span class="line">            <span class="attr">maxSize</span>: <span class="number">8</span>*<span class="number">1024</span>		<span class="comment">// 设置自动选择临界值</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="6-devServer">
          <a href="#6-devServer" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-devServer" class="headerlink" title="6.devServer"></a>6.devServer</h2>
      <figure class="highlight shell"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 需要安装webpack-dev-server</span></span><br><span class="line">npm install webpack-dev-server</span><br></pre></td></tr></table></div></figure>

<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;...&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[...]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[...],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">    <span class="comment">// 作用：自动化(自动编译，自动打开浏览器，自动刷新浏览器......)</span></span><br><span class="line">    <span class="attr">devServer</span>:&#123;</span><br><span class="line">        <span class="comment">// 构建后路径</span></span><br><span class="line">        <span class="attr">static</span>:resolve(__dirname, <span class="string">&#x27;./dist&#x27;</span>),</span><br><span class="line">        <span class="comment">// 启动gzip压缩</span></span><br><span class="line">        <span class="attr">compress</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 端口号</span></span><br><span class="line">        <span class="attr">port</span>:<span class="number">3000</span>,</span><br><span class="line">        <span class="comment">// 自动打开浏览器</span></span><br><span class="line">        <span class="attr">open</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 添加头部信息</span></span><br><span class="line">        <span class="attr">headers</span>:&#123;</span><br><span class="line">            <span class="string">&#x27;x-Access-Token&#x27;</span>:<span class="string">&#x27;xxx&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 服务器代理</span></span><br><span class="line">        <span class="comment">/* </span></span><br><span class="line"><span class="comment">        	作用：本地调试解决跨域问题</span></span><br><span class="line"><span class="comment">        	假如后端服务运行在http://localhost:9000，请求地址http://localhost:9000/api/hello</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="attr">proxy</span>:&#123;</span><br><span class="line">            <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">                <span class="attr">target</span>:<span class="string">&#x27;http://localhost:9000&#x27;</span>,	<span class="comment">// 开启代理后，请求地址/api/hello -&gt; http://localhost:9000/api/hello</span></span><br><span class="line">                <span class="attr">pathRewrite</span>: &#123;<span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;	<span class="comment">// 如果重写路径，请求地址/api/hello -&gt; http://localhost:9000/hello</span></span><br><span class="line">            &#125;	</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	如果开发SPA（单页面应用），浏览器在刷新或跳转页面时可能会报错（404）</span></span><br><span class="line"><span class="comment">        	这类单页应用要求服务器在针对任何命中的路由时都返回一个对应的HTML文件</span></span><br><span class="line"><span class="comment">        	配置historyApiFallback可以解决这一问题，这会使得任何请求都会返回根页面</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="attr">historyApiFallback</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 允许局域网内访问</span></span><br><span class="line">        <span class="attr">host</span>:<span class="string">&#x27;0.0.0.0&#x27;</span>,</span><br><span class="line">        <span class="attr">client</span>:&#123;</span><br><span class="line">            <span class="comment">// 取消发生错误时的覆盖层</span></span><br><span class="line">            <span class="attr">overlay</span>:<span class="literal">false</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight shell"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 执行webpack serve</span></span><br><span class="line">npx webpack serve</span><br></pre></td></tr></table></div></figure>


        <h2 id="7-提取css成单独文件及css兼容性处理">
          <a href="#7-提取css成单独文件及css兼容性处理" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-提取css成单独文件及css兼容性处理" class="headerlink" title="7.提取css成单独文件及css兼容性处理"></a>7.提取css成单独文件及css兼容性处理</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置nodejs环境变量，决定使用browserslist的哪个环境</span></span><br><span class="line">process.env,NODE_ENV = <span class="string">&#x27;development&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,	<span class="comment">// 可以加文件夹js/built.js，即打包到build/js文件夹下</span></span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    <span class="comment">// &#x27;style-loader&#x27;,</span></span><br><span class="line">                    <span class="comment">// 这个loader代替style-loader，将js中的css提取成单独文件</span></span><br><span class="line">                    MiniCssExtractPlugin.loader,</span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span>，</span><br><span class="line">                    <span class="comment">/*</span></span><br><span class="line"><span class="comment">                    	css兼容性处理:postcss --&gt; postcss-loader postcss-preset-env</span></span><br><span class="line"><span class="comment">                    	帮postcss找到package.json中browserslist里面的配置，通过配置加载指定的css兼容性样式</span></span><br><span class="line"><span class="comment">                    */</span></span><br><span class="line">                    <span class="comment">// 1.使用loader的默认配置</span></span><br><span class="line">                    <span class="comment">// &#x27;postcss-loader&#x27;,</span></span><br><span class="line">                    <span class="comment">// 2.修改loader的配置,</span></span><br><span class="line">                    &#123;</span><br><span class="line">                    	<span class="attr">loader</span>:<span class="string">&#x27;postcss-loader&#x27;</span>,</span><br><span class="line">                    	<span class="attr">options</span>:&#123;</span><br><span class="line">                    		<span class="attr">ident</span>:<span class="string">&#x27;postcss&#x27;</span>,</span><br><span class="line">                    		<span class="attr">plugins</span>:<span class="function">()=&gt;</span>[</span><br><span class="line">                				<span class="comment">// postcss的插件</span></span><br><span class="line">                				<span class="built_in">require</span>(<span class="string">&#x27;postcss-preset-env&#x27;</span>)()</span><br><span class="line">                			]</span><br><span class="line">                    	&#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            <span class="attr">filename</span>:<span class="string">&#x27;css/built.css&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight json"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;name&quot;</span>: <span class="string">&quot;webpack&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;main&quot;</span>: <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    	<span class="attr">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  	&#125;,</span><br><span class="line">  	<span class="attr">&quot;author&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;license&quot;</span>: <span class="string">&quot;ISC&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;devDependencies&quot;</span>: &#123;...&#125;,</span><br><span class="line">  	<span class="attr">&quot;browserslist&quot;</span>:&#123;</span><br><span class="line">    	<span class="comment">// 开发环境</span></span><br><span class="line">    	<span class="attr">&quot;development&quot;</span>:[</span><br><span class="line">        	<span class="string">&quot;last 1 chrome version&quot;</span>,</span><br><span class="line">        	<span class="string">&quot;last 1 firefox version&quot;</span>,</span><br><span class="line">        	<span class="string">&quot;last 1 safari version&quot;</span>,</span><br><span class="line">    	],</span><br><span class="line">    	<span class="comment">// 生产环境(默认)</span></span><br><span class="line">    	<span class="attr">&quot;production&quot;</span>:[</span><br><span class="line">        	<span class="string">&quot;&gt;0.2%&quot;</span>,</span><br><span class="line">        	<span class="string">&quot;not dead&quot;</span>,</span><br><span class="line">        	<span class="string">&quot;not op_mini all&quot;</span></span><br><span class="line">    	]</span><br><span class="line">  	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="8-css压缩">
          <a href="#8-css压缩" class="heading-link"><i class="fas fa-link"></i></a><a href="#8-css压缩" class="headerlink" title="8.css压缩"></a>8.css压缩</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>)</span><br><span class="line"><span class="comment">// 压缩css文件</span></span><br><span class="line"><span class="keyword">const</span> CssMinimizerWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;css-minimizer-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cssMinimizerWebpackPlugin = <span class="keyword">new</span> CssMinimizerWebpackPlugin();</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    MiniCssExtractPlugin.loader,</span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            <span class="attr">filename</span>:<span class="string">&#x27;css/built.css&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">optimization</span>:&#123;</span><br><span class="line">    	<span class="attr">minimizer</span>:[</span><br><span class="line">    		cssMinimizerWebpackPlugin</span><br><span class="line">    	]</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="9-js的兼容性处理">
          <a href="#9-js的兼容性处理" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-js的兼容性处理" class="headerlink" title="9.js的兼容性处理"></a>9.js的兼容性处理</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		<span class="comment">/*</span></span><br><span class="line"><span class="comment">    			js兼容性处理:babel-loader</span></span><br><span class="line"><span class="comment">    				*1.基本js兼容性处理 --&gt; @babel/preset-env</span></span><br><span class="line"><span class="comment">    					问题：只能转换基本语法，如promise不能转换</span></span><br><span class="line"><span class="comment">    				2.全部js兼容性处理 --&gt; @babel/polyfill</span></span><br><span class="line"><span class="comment">    					问题：只要解决部分兼容问题时，但是将所有兼容性代码全部引入，体积太大</span></span><br><span class="line"><span class="comment">    				*3.按需加载 --&gt; corejs</span></span><br><span class="line"><span class="comment">    		*/</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.js$/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">exclude</span>:<span class="regexp">/node_modules/</span>,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    <span class="comment">// 预设：指示babel做怎么样的兼容性处理</span></span><br><span class="line">                    <span class="comment">// presets:[&#x27;@babel/preset-env&#x27;]</span></span><br><span class="line">                    <span class="attr">presets</span>:[</span><br><span class="line">                        [</span><br><span class="line">                            <span class="string">&#x27;@babel/preset-env&#x27;</span>,</span><br><span class="line">                        	&#123;</span><br><span class="line">                            	<span class="attr">useBuiltIns</span>:<span class="string">&#x27;usage&#x27;</span>,</span><br><span class="line">                            	<span class="comment">// 指定core-js版本</span></span><br><span class="line">                            	<span class="attr">corejs</span>:&#123;</span><br><span class="line">                               	 	<span class="attr">version</span>:<span class="number">3</span></span><br><span class="line">                            	&#125;,</span><br><span class="line">                            	<span class="comment">// 指定兼容性做到哪个版本浏览器</span></span><br><span class="line">                            	<span class="attr">targets</span>:&#123;</span><br><span class="line">                                	<span class="attr">chrome</span>:<span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">                                	<span class="attr">firefox</span>:<span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">                                	<span class="attr">ie</span>:<span class="string">&#x27;10&#x27;</span>,</span><br><span class="line">                                	<span class="attr">safari</span>:<span class="string">&#x27;10&#x27;</span>,</span><br><span class="line">                                	<span class="attr">edge</span>:<span class="string">&#x27;17&#x27;</span>,</span><br><span class="line">                            	&#125;</span><br><span class="line">                        	&#125;</span><br><span class="line">                    	]</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        </span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

        <h2 id="10-js的语法检查">
          <a href="#10-js的语法检查" class="heading-link"><i class="fas fa-link"></i></a><a href="#10-js的语法检查" class="headerlink" title="10.js的语法检查"></a>10.js的语法检查</h2>
      <figure class="highlight shell"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装eslint</span></span><br><span class="line">npx eslint --init</span><br><span class="line"><span class="meta">#</span><span class="bash"> 检查文件是否规范</span></span><br><span class="line">npx eslint ./src</span><br></pre></td></tr></table></div></figure>

<figure class="highlight json"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .eslintrc.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;env&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;browser&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">&quot;es2021&quot;</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;extends&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;airbnb-base&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;parserOptions&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;ecmaVersion&quot;</span>:<span class="number">12</span>,</span><br><span class="line">        <span class="attr">&quot;sourceType&quot;</span>:<span class="string">&quot;module&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;rules&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;no-console&quot;</span>:<span class="number">0</span>	<span class="comment">// 关闭no-console警告</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;globals&quot;</span>:&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">test</span>:<span class="regexp">/\.(js|jsx)/</span>,</span><br><span class="line">    exclude:<span class="regexp">/node_modules/</span>,</span><br><span class="line">    use:[<span class="string">&#x27;babel-loader&#x27;</span>,<span class="string">&#x27;eslint-loader&#x27;</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="11-html和js的压缩">
          <a href="#11-html和js的压缩" class="heading-link"><i class="fas fa-link"></i></a><a href="#11-html和js的压缩" class="headerlink" title="11.html和js的压缩"></a>11.html和js的压缩</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="comment">// 压缩css文件</span></span><br><span class="line"><span class="keyword">const</span> CssMinimizerWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;css-minimizer-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cssMinimizerWebpackPlugin = <span class="keyword">new</span> CssMinimizerWebpackPlugin();</span><br><span class="line"><span class="comment">// 压缩js</span></span><br><span class="line"><span class="keyword">const</span> TerserWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;terser-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> terserWebpackPlugin = <span class="keyword">new</span> TerserWebpackPlugin(&#123;</span><br><span class="line">    <span class="attr">extractComments</span>: <span class="literal">false</span>, <span class="comment">// 不将注释提取为单独文件（打包后不会出现.LICENSE.txt文件）</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span>,</span><br><span class="line">            <span class="attr">minify</span>:&#123;</span><br><span class="line">                <span class="comment">// 移除空格</span></span><br><span class="line">                <span class="attr">collapseWhitespace</span>:<span class="literal">true</span>,</span><br><span class="line">                <span class="comment">// 移除注释</span></span><br><span class="line">                <span class="attr">removeComments</span>:<span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        </span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 生产环境下会自动压缩js代码</span></span><br><span class="line">    <span class="comment">// 如果配置了optimization minimizer,需要单独配置terser，js压缩才生效</span></span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">    <span class="attr">optimization</span>:&#123;</span><br><span class="line">        <span class="attr">minimizer</span>:[</span><br><span class="line">    		cssMinimizerWebpackPlugin,</span><br><span class="line">            terserWebpackPlugin</span><br><span class="line">    	]</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h1 id="四-Webpack性能优化">
          <a href="#四-Webpack性能优化" class="heading-link"><i class="fas fa-link"></i></a><a href="#四-Webpack性能优化" class="headerlink" title="四.Webpack性能优化"></a>四.Webpack性能优化</h1>
      
        <h2 id="1-开发环境性能优化">
          <a href="#1-开发环境性能优化" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-开发环境性能优化" class="headerlink" title="1.开发环境性能优化"></a>1.开发环境性能优化</h2>
      
        <h3 id="1-热替换">
          <a href="#1-热替换" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-热替换" class="headerlink" title="(1) 热替换"></a>(1) 热替换</h3>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	HMR:hot module replacement 热模块替换/模块热替换</span></span><br><span class="line"><span class="comment">	作用:一个模块发生变化，只会重新打包这一个模块，而不是打包所有，极大提升打包构建速度</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	css文件:可以使用HMR功能，style-loader中实现了</span></span><br><span class="line"><span class="comment">	js文件:默认不能使用HMR功能</span></span><br><span class="line"><span class="comment">		解决:修改js代码，添加支持HMR功能的代码</span></span><br><span class="line"><span class="comment">		注意:HMR功能对js的处理，只能处理非入口js文件的其他文件</span></span><br><span class="line"><span class="comment">	html文件:默认不能使用HMR功能，同时会导致Html文件不能热更新(不用做HMR功能)</span></span><br><span class="line"><span class="comment">		解决:修改entry入口，将html文件引入</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:[<span class="string">&#x27;./src/index.js&#x27;</span>,<span class="string">&#x27;./src/index.html&#x27;</span>],</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[<span class="string">&#x27;style-loader&#x27;</span>,<span class="string">&#x27;css-loader&#x27;</span>]</span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">devServer</span>:&#123;</span><br><span class="line">        <span class="attr">contentBase</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>),</span><br><span class="line">        <span class="attr">compress</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">port</span>:<span class="number">3000</span>,</span><br><span class="line">        <span class="attr">open</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 开启HMR功能（默认开启）</span></span><br><span class="line">    	<span class="attr">hot</span>:<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>js文件修改</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在入口文件末尾添加这段代码</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">module</span>.hot)&#123;</span><br><span class="line">    <span class="built_in">module</span>.hot.accept([filename],<span class="function">()=&gt;</span>&#123;&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="2-热加载">
          <a href="#2-热加载" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-热加载" class="headerlink" title="(2) 热加载"></a>(2) 热加载</h3>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	作用：当模块发生变化时，页面重新加载</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:[<span class="string">&#x27;./src/index.js&#x27;</span>,<span class="string">&#x27;./src/index.html&#x27;</span>],</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[<span class="string">&#x27;style-loader&#x27;</span>,<span class="string">&#x27;css-loader&#x27;</span>]</span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">devServer</span>:&#123;</span><br><span class="line">        <span class="attr">contentBase</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>),</span><br><span class="line">        <span class="attr">compress</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">port</span>:<span class="number">3000</span>,</span><br><span class="line">        <span class="attr">open</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 热加载（默认开启）</span></span><br><span class="line">        <span class="attr">liveReload</span>:<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="3-source-map">
          <a href="#3-source-map" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-source-map" class="headerlink" title="(3) source-map"></a>(3) source-map</h3>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	source-map:一种提供 源代码到构建后代码映射 的技术</span></span><br><span class="line"><span class="comment">				如果构建后代码出错了，通过映射关系可以追踪到源代码错误</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:[...],</span><br><span class="line">    <span class="attr">output</span>:&#123;...&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[...]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[...],</span><br><span class="line">    <span class="attr">devServer</span>:&#123;...&#125;</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">   	<span class="attr">devtool</span>:<span class="string">&#x27;source-map&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	有以下几个参数</span></span><br><span class="line"><span class="comment">	[inline-|hidden-|eval-][nosources-][cheap-[module-]]source-map</span></span><br><span class="line"><span class="comment">	如:devtool:&#x27;inline-source-map&#x27;</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	常见的几种source-map：</span></span><br><span class="line"><span class="comment">	(none)：生产环境默认值（省略devtool选项）</span></span><br><span class="line"><span class="comment">		不产生souce-map</span></span><br><span class="line"><span class="comment">	eval：开发环境默认值</span></span><br><span class="line"><span class="comment">		每个module都会通过eval()来执行，并且会在末尾追加注释//# sourceURL=xx.js</span></span><br><span class="line"><span class="comment">		提示 源代码位置</span></span><br><span class="line"><span class="comment">	source-map:</span></span><br><span class="line"><span class="comment">		生成一个.map文件，并在末尾追加注释//# sourceMappingURL=xxx.js.map指定JS引擎文件</span></span><br><span class="line"><span class="comment">		提示 源代码位置</span></span><br><span class="line"><span class="comment">	hidden-source-map:</span></span><br><span class="line"><span class="comment">		生成一个.map文件，但是不会在末尾追加注释</span></span><br><span class="line"><span class="comment">		提示 构建后代码位置</span></span><br><span class="line"><span class="comment">	inline-source-map:</span></span><br><span class="line"><span class="comment">		不会生成.map文件，而是为每个文件添加source-map的DataURL，这个DataURL是包含一个文件完成source-map信息的Base64编码，会导致文件很大</span></span><br><span class="line"><span class="comment">		提示 源代码位置</span></span><br><span class="line"><span class="comment">	eval-source-map:</span></span><br><span class="line"><span class="comment">		每个module都会通过eval()来执行，把eval的sourceURL换为完整source-map信息的DataURL</span></span><br><span class="line"><span class="comment">		提示 源代码位置，并且多一个唯一标识</span></span><br><span class="line"><span class="comment">	cheap-source-map:</span></span><br><span class="line"><span class="comment">		生成一个.map文件，但是文件中只包含行数，不包含列信息</span></span><br><span class="line"><span class="comment">		提示 源代码位置，但是只能精确到行，不能精确到列</span></span><br><span class="line"><span class="comment">	cheap-module-source-map:</span></span><br><span class="line"><span class="comment">		生成一个.map文件，但是文件中只包含行数，不包含列信息，同时对loader的source-map也进行简化</span></span><br><span class="line"><span class="comment">		提示 源代码位置，但是只能精确到行，不能精确到列</span></span><br><span class="line"><span class="comment">		module会将loader的source-map加入</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	开发环境:eval-cheap-module-source-map</span></span><br><span class="line"><span class="comment">		eval构建速度快，同时每行代码并不会很长，所以选择cheap能进一步提高打包效率，而module能避免loader的source-map混杂，对于源代码提示位置更准确清晰</span></span><br><span class="line"><span class="comment">	生产环境:(none)</span></span><br><span class="line"><span class="comment">		source-map会暴露源代码，同时source-map文件体积相对比较巨大，与我们追求的更小更轻量的bundle相违背</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="2-生产环境性能优化">
          <a href="#2-生产环境性能优化" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-生产环境性能优化" class="headerlink" title="2.生产环境性能优化"></a>2.生产环境性能优化</h2>
      
        <h3 id="1-oneOf-缓存-tree-shaking">
          <a href="#1-oneOf-缓存-tree-shaking" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-oneOf-缓存-tree-shaking" class="headerlink" title="(1) oneOf/缓存/tree shaking"></a>(1) oneOf/缓存/tree shaking</h3>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	缓存:</span></span><br><span class="line"><span class="comment">		babel缓存</span></span><br><span class="line"><span class="comment">			cacheDirectory:true</span></span><br><span class="line"><span class="comment">			--&gt;让第二次打包构建速度更快</span></span><br><span class="line"><span class="comment">		文件资源缓存</span></span><br><span class="line"><span class="comment">			hash:每次webpack构建时会生成一个唯一的hash值</span></span><br><span class="line"><span class="comment">			问题:因为js和css同时使用一个hash值。如果重新打包，会导致所有缓存失效</span></span><br><span class="line"><span class="comment">			chunkhash:根据chunk生成的hash值，如果打包来源于同一个chunk，那么hash值一样</span></span><br><span class="line"><span class="comment">			问题:js和css的hash值还是一样的,因为css是在js中被引入的，所以同属于一个chunk</span></span><br><span class="line"><span class="comment">			contenthash:根据文件的内容生成hash值。不同文件hash值一定不同，并且单独管理</span></span><br><span class="line"><span class="comment">			--&gt;让代码上线运行缓存更好使用</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	tree shaking:去除无用代码</span></span><br><span class="line"><span class="comment">		前提:1.必须使用es6模块化 2.开启production环境</span></span><br><span class="line"><span class="comment">		作用:减少代码体积</span></span><br><span class="line"><span class="comment">		在package.json中配置</span></span><br><span class="line"><span class="comment">			&quot;sideEffects&quot;:false 所有代码都没有副作用(都可以进行tree shaking)</span></span><br><span class="line"><span class="comment">			问题:可能会把css文件等文件干掉</span></span><br><span class="line"><span class="comment">			解决:&quot;sideEffects&quot;:[&quot;*.css&quot;]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/built.[contenthash:10].js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">        <span class="attr">rules</span>:[</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.js$/</span>,</span><br><span class="line">                exclude:<span class="regexp">/node_modules/</span>,</span><br><span class="line">                enforce:<span class="string">&#x27;pre&#x27;</span>,</span><br><span class="line">                <span class="attr">loader</span>:<span class="string">&#x27;eslint-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>:&#123;</span><br><span class="line">                	<span class="attr">fix</span>:<span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 以下loader只会匹配一个,匹配到后就不再进行匹配</span></span><br><span class="line">                <span class="comment">// 注意:不能有两个配置处理同一种类型文件</span></span><br><span class="line">                <span class="comment">//		如果相同文件，可提取到oneOf之外</span></span><br><span class="line">                <span class="attr">oneOf</span>:[</span><br><span class="line">                    &#123;</span><br><span class="line">                		<span class="attr">test</span>:<span class="regexp">/.css$/</span>,</span><br><span class="line">                		use:[...commonCssLoader]</span><br><span class="line">            		&#125;,</span><br><span class="line">            		&#123;</span><br><span class="line">                		<span class="attr">test</span>:<span class="regexp">/.less$/</span>,</span><br><span class="line">                		use:[...commonCssLoader,<span class="string">&#x27;less-loader&#x27;</span>]</span><br><span class="line">            		&#125;,</span><br><span class="line">            		&#123;</span><br><span class="line">                		<span class="attr">test</span>:<span class="regexp">/\.js$/</span>,</span><br><span class="line">                		exclude:<span class="regexp">/node_modules/</span>,</span><br><span class="line">                		loader:<span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">                		<span class="attr">options</span>:&#123;</span><br><span class="line">                    		<span class="attr">presets</span>:[</span><br><span class="line">                        		[</span><br><span class="line">                            		<span class="string">&#x27;@babel/preset-env&#x27;</span>,</span><br><span class="line">                         			&#123;</span><br><span class="line">                                		<span class="attr">useBuiltIns</span>:<span class="string">&#x27;usage&#x27;</span>,</span><br><span class="line">                                		<span class="attr">corejs</span>:&#123;<span class="attr">version</span>:<span class="number">3</span>&#125;,</span><br><span class="line">                                		<span class="attr">targets</span>:&#123;</span><br><span class="line">                                    		<span class="attr">chrome</span>:<span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">                                    		<span class="attr">firefox</span>:<span class="string">&#x27;50&#x27;</span></span><br><span class="line">                                		&#125;</span><br><span class="line">                            		&#125;</span><br><span class="line">                        		]</span><br><span class="line">                    		],</span><br><span class="line">                            <span class="comment">// 开启babel缓存</span></span><br><span class="line">                            <span class="comment">// 第二次构建时，会读取之前的缓存</span></span><br><span class="line">                            <span class="attr">cacheDirectory</span>:<span class="literal">true</span></span><br><span class="line">                		&#125;</span><br><span class="line">            		&#125;,</span><br><span class="line">            		&#123;</span><br><span class="line">                		<span class="attr">test</span>:<span class="regexp">/\.(jpg|png|gif)$/</span>,</span><br><span class="line">                		loader:<span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">                		<span class="attr">options</span>:&#123;</span><br><span class="line">                    		<span class="attr">limit</span>:<span class="number">8</span>*<span class="number">1024</span>,</span><br><span class="line">                    		<span class="attr">name</span>:<span class="string">&#x27;[hash:10].[ext]&#x27;</span>,</span><br><span class="line">                    		<span class="attr">outputPath</span>:<span class="string">&#x27;imgs&#x27;</span>,</span><br><span class="line">                    		<span class="attr">esModule</span>:<span class="literal">false</span></span><br><span class="line">                		&#125;</span><br><span class="line">            		&#125;,</span><br><span class="line">            		&#123;</span><br><span class="line">                		<span class="attr">test</span>:<span class="regexp">/\.html$/</span>,</span><br><span class="line">                		loader:<span class="string">&#x27;html-loader&#x27;</span></span><br><span class="line">            		&#125;,</span><br><span class="line">            		&#123;</span><br><span class="line">                		<span class="attr">exclude</span>:<span class="regexp">/\.(js|css|less|html|jpg|png|gif)$/</span>,</span><br><span class="line">                		loader:<span class="string">&#x27;file-loader&#x27;</span>,</span><br><span class="line">                		<span class="attr">options</span>:&#123;</span><br><span class="line">                    		<span class="attr">outputPath</span>:<span class="string">&#x27;media&#x27;</span></span><br><span class="line">                		&#125;</span><br><span class="line">            		&#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[...],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="2-代码分割">
          <a href="#2-代码分割" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-代码分割" class="headerlink" title="(2) 代码分割"></a>(2) 代码分割</h3>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="comment">// 单入口</span></span><br><span class="line">    <span class="comment">// entry:&#x27;./src/index.js&#x27;</span></span><br><span class="line">    <span class="attr">entry</span>:&#123;</span><br><span class="line">        <span class="comment">// 多入口:有一个入口，最终输出就有一个bundle</span></span><br><span class="line">        <span class="attr">index</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">        <span class="attr">test</span>:<span class="string">&#x27;./src/test.js&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="comment">// [name]:取文件名</span></span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/[name].[contenthash:10].js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[...],</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    	1.可以将node_modules中代码单独打包一个chunk最终输出</span></span><br><span class="line"><span class="comment">    		作用：当自身代码更新后，浏览器会重新获取，但第三方库缓存仍然生效</span></span><br><span class="line"><span class="comment">    	2.自动分析多入口chunk中有没有公共的文件。如果有会打包成单独一个chunk</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="attr">optimization</span>:&#123;</span><br><span class="line">        <span class="attr">splitChunks</span>:&#123;</span><br><span class="line">            <span class="attr">cacheGroups</span>:&#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">             	name:<span class="string">&#x27;vendors&#x27;</span>,</span><br><span class="line">                <span class="attr">chunks</span>:<span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="3-懒加载-预加载">
          <a href="#3-懒加载-预加载" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-懒加载-预加载" class="headerlink" title="(3) 懒加载/预加载"></a>(3) 懒加载/预加载</h3>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;index.js文件被加载&#x27;</span>)</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;btn&#x27;</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">/* lazy loading:懒加载 </span></span><br><span class="line"><span class="comment">    		当文件需要时才加载</span></span><br><span class="line"><span class="comment">    	prefetch:预加载</span></span><br><span class="line"><span class="comment">    		会在使用之前，提前加载js文件</span></span><br><span class="line"><span class="comment">    	正常加载可以认为是并行加载(同一时间加载多个文件)</span></span><br><span class="line"><span class="comment">    	预加载等其他资源加载完毕，浏览器空闲了再偷偷加载。(兼容性差，慎用)</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="comment">// 动态引入会单独打包成一个chunk</span></span><br><span class="line">    <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: &#x27;test&#x27;, webpackPrefetch:true */</span><span class="string">&#x27;./test&#x27;</span>)</span><br><span class="line">    	.then(<span class="function">(<span class="params">&#123;ml&#125;</span>)=&gt;</span>&#123;</span><br><span class="line">        	<span class="built_in">console</span>.log(ml(<span class="number">4</span>,<span class="number">5</span>))</span><br><span class="line">    	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="4-PWA-渐进式网络开发应用程序">
          <a href="#4-PWA-渐进式网络开发应用程序" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-PWA-渐进式网络开发应用程序" class="headerlink" title="(4) PWA(渐进式网络开发应用程序)"></a>(4) PWA(渐进式网络开发应用程序)</h3>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	PWA:渐进式网络开发应用程序(离线可访问)</span></span><br><span class="line"><span class="comment">		workbox --&gt; workbox-webpack-plugin</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> WorkboxWebpackPlugin= <span class="built_in">require</span>(<span class="string">&#x27;workbox-webpack-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="attr">plugins</span>:[</span><br><span class="line">    <span class="keyword">new</span> WorkboxWebpackPlugin.GenerateSW(&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	1.帮助serviceworker快速启动</span></span><br><span class="line"><span class="comment">        	2.删除旧的serviceworker</span></span><br><span class="line"><span class="comment">        	生成一个serviceworker配置文件</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="attr">clientsClaim</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">skipWaiting</span>:<span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 以下代码在入口文件中使用 */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	会有几个问题:</span></span><br><span class="line"><span class="comment">	1.eslint不认识window、navigator全局变量</span></span><br><span class="line"><span class="comment">		解决:需要修改package.json中eslintConfig配置</span></span><br><span class="line"><span class="comment">			&quot;env&quot;:&#123;</span></span><br><span class="line"><span class="comment">				&quot;browser&quot;:true // 支持浏览器端全局变量</span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment">	2.sw代码必须运行在服务器上</span></span><br><span class="line"><span class="comment">		--&gt; nodejs</span></span><br><span class="line"><span class="comment">		--&gt; npm i serve -g</span></span><br><span class="line"><span class="comment">			serve -s [要运行代码的目录] </span></span><br><span class="line"><span class="comment">			如:serve -s build，将Build目录下所有资源作为静态资源暴露出去</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;serviceworker&#x27;</span> <span class="keyword">in</span> navigator)&#123;</span><br><span class="line">	<span class="built_in">window</span>.addEventListener(<span class="string">&#x27;load&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        navigator.serviceworker.register(<span class="string">&#x27;/service-worker.js&#x27;</span>)</span><br><span class="line">        .then(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;sw注册成功&#x27;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;sw注册失败&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="5-多进程打包">
          <a href="#5-多进程打包" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-多进程打包" class="headerlink" title="(5) 多进程打包"></a>(5) 多进程打包</h3>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一般给babel-loader用</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">test</span>:<span class="regexp">/\.js$/</span>,</span><br><span class="line">    exclude:<span class="regexp">/node_modules/</span>,</span><br><span class="line">    use:[</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	开启多进程打包(慎用)</span></span><br><span class="line"><span class="comment">        	进程启动大概600ms，进程通信也有开销</span></span><br><span class="line"><span class="comment">        	只有工作消耗时间比较长，才使用多进程打包</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="string">&#x27;thread-loader&#x27;</span>,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">loader</span>:<span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">            <span class="attr">options</span>:&#123;</span><br><span class="line">                <span class="attr">presets</span>:[</span><br><span class="line">					[</span><br><span class="line">                    	<span class="string">&#x27;@babel/preset-env&#x27;</span>,</span><br><span class="line">                     	&#123;</span><br><span class="line">                     		<span class="attr">useBuiltIns</span>:<span class="string">&#x27;usage&#x27;</span>,</span><br><span class="line">                     		<span class="attr">corejs</span>:&#123;<span class="attr">version</span>:<span class="number">3</span>&#125;,</span><br><span class="line">                     		<span class="attr">targets</span>:&#123;</span><br><span class="line">                     			<span class="attr">chrome</span>:<span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">                     			<span class="attr">firefox</span>:<span class="string">&#x27;50&#x27;</span></span><br><span class="line">                     		&#125;</span><br><span class="line">                     	&#125;</span><br><span class="line">                     ]</span><br><span class="line">            	],</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="6-externals">
          <a href="#6-externals" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-externals" class="headerlink" title="(6) externals"></a>(6) externals</h3>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span></span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">    <span class="attr">externals</span>:&#123;</span><br><span class="line">        <span class="comment">// 拒绝jQuery被打包进来</span></span><br><span class="line">        <span class="comment">// 当忽略对应的包后，需要用cdn引入</span></span><br><span class="line">        <span class="attr">jquery</span>:<span class="string">&#x27;jQuery&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="7-dll">
          <a href="#7-dll" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-dll" class="headerlink" title="(7) dll"></a>(7) dll</h3>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	使用dll技术，对某些库(第三方库:jquery、react、vue...)进行单独打包</span></span><br><span class="line"><span class="comment">	当运行webpack时，默认查找webpack.config.js配置文件</span></span><br><span class="line"><span class="comment">	需求:需要运行新的配置文件webpack.dll.js文件</span></span><br><span class="line"><span class="comment">		--&gt; webpack --config webpack.dll.js</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 以下是一个新的配置文件 */</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:&#123;</span><br><span class="line">        <span class="comment">// 最终打包生成的[name] --&gt; jquery</span></span><br><span class="line">        <span class="comment">// [&#x27;jquery&#x27;] --&gt; 要打包的库是jquery</span></span><br><span class="line">        <span class="attr">jquery</span>:[<span class="string">&#x27;jquery&#x27;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;[name].js&#x27;</span>,</span><br><span class="line">    	<span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;dll&#x27;</span>),</span><br><span class="line">        <span class="attr">library</span>:<span class="string">&#x27;[name]_[hash]&#x27;</span>,	<span class="comment">// 打包的库里面向外暴露出去的内容叫什么名字</span></span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="comment">// 打包生成一个mainfest.json --&gt; 提供和jquery映射</span></span><br><span class="line">        <span class="keyword">new</span> webpack.Dllplugin(&#123;</span><br><span class="line">            <span class="attr">name</span>:<span class="string">&#x27;[name]_[hash]&#x27;</span>,	<span class="comment">// 映射库的暴露的内容名称</span></span><br><span class="line">            <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;dll/manifest.json&#x27;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 以下是webpack.config.js */</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> AddAssetHtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;add-asset-html-webpack-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span></span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">// 告诉webpack哪些库不参与打包,同时使用时的名称也得改</span></span><br><span class="line">        <span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</span><br><span class="line">            <span class="attr">mainfest</span>:resolve(__dirname,<span class="string">&#x27;dll/manifest.json&#x27;</span>)</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">// 将某个文件打包输出去，并在Html自动引入该资源</span></span><br><span class="line">        <span class="keyword">new</span> AddAssetHtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">filepath</span>:resolve(__dirname,<span class="string">&#x27;dll/jquery.js&#x27;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="3-性能优化总结">
          <a href="#3-性能优化总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-性能优化总结" class="headerlink" title="3.性能优化总结"></a>3.性能优化总结</h2>
      <p>webpack性能优化：</p>
<ul>
<li>开发环境性能优化</li>
<li>生产环境性能优化</li>
</ul>

        <h3 id="开发环境性能优化">
          <a href="#开发环境性能优化" class="heading-link"><i class="fas fa-link"></i></a><a href="#开发环境性能优化" class="headerlink" title="开发环境性能优化"></a>开发环境性能优化</h3>
      <ul>
<li>优化代码构建速度<ul>
<li>热替换</li>
</ul>
</li>
<li>优化代码调试<ul>
<li>热加载</li>
<li>source-map</li>
</ul>
</li>
</ul>

        <h3 id="生产环境性能优化">
          <a href="#生产环境性能优化" class="heading-link"><i class="fas fa-link"></i></a><a href="#生产环境性能优化" class="headerlink" title="生产环境性能优化"></a>生产环境性能优化</h3>
      <ul>
<li>优化打包构建速度<ul>
<li>oneOf</li>
<li>babel缓存</li>
<li>多进程打包</li>
<li>externals</li>
<li>dll</li>
</ul>
</li>
<li>优化代码运行的性能<ul>
<li>缓存（hash-chunkhash-contenthash）</li>
<li>tree shaking</li>
<li>code split</li>
<li>懒加载/预加载</li>
<li>pwa</li>
</ul>
</li>
</ul>

        <h1 id="五-Webpack详细配置">
          <a href="#五-Webpack详细配置" class="heading-link"><i class="fas fa-link"></i></a><a href="#五-Webpack详细配置" class="headerlink" title="五.Webpack详细配置"></a>五.Webpack详细配置</h1>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> HtmlPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlPlugin = <span class="keyword">new</span> HtmlPlugin(&#123;</span><br><span class="line">    <span class="attr">template</span>: <span class="string">&quot;./src/index.html&quot;</span>,</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;index.html&quot;</span>,</span><br><span class="line">    <span class="attr">inject</span>:<span class="string">&quot;body&quot;</span>	<span class="comment">// 将script标签放入body标签中（默认在head中）</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将css单独打包成一个文件</span></span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&quot;mini-css-extract-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> miniCssExtractPlugin = <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;css/[name].[contenthash:8].css&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 压缩css文件</span></span><br><span class="line"><span class="keyword">const</span> CssMinimizerWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;css-minimizer-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cssMinimizerWebpackPlugin = <span class="keyword">new</span> CssMinimizerWebpackPlugin();</span><br><span class="line"><span class="comment">// 压缩js</span></span><br><span class="line"><span class="keyword">const</span> TerserWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;terser-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> terserWebpackPlugin = <span class="keyword">new</span> TerserWebpackPlugin(&#123;</span><br><span class="line">    <span class="attr">extractComments</span>: <span class="literal">false</span>, <span class="comment">// 不将注释提取为单独文件（打包后不会出现.LICENSE.txt文件）</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    	entry:入口起点</span></span><br><span class="line"><span class="comment">    	1.String -&gt; &#x27;./src/index.js&#x27;</span></span><br><span class="line"><span class="comment">    		单入口</span></span><br><span class="line"><span class="comment">    		打包形成一个chunk，输出一个bundle文件。此时chunk的名称默认是main</span></span><br><span class="line"><span class="comment">    	2.Array -&gt; [&#x27;./src/index.js&#x27;,&#x27;./src/add.js&#x27;]</span></span><br><span class="line"><span class="comment">    		多入口</span></span><br><span class="line"><span class="comment">    		所有入口文件最终只会形成一个chunk，输出出去只有一个bundle文件</span></span><br><span class="line"><span class="comment">    		只有在HMR功能中让html热更新生效</span></span><br><span class="line"><span class="comment">    	3.Object -&gt; &#123;index:&#x27;./src/index.js&#x27;, add: &#x27;./src/add.js&#x27;&#125;</span></span><br><span class="line"><span class="comment">    		多入口</span></span><br><span class="line"><span class="comment">    		有几个入口文件就形成几个chunk，输出几个bundle文件。此时chunk的名称是Object的key</span></span><br><span class="line"><span class="comment">    	  特殊用法 -&gt; &#123;index:[&#x27;./src/index.js&#x27;,&#x27;./src/count.js&#x27;], add: &#x27;./src/add.js&#x27;&#125;</span></span><br><span class="line"><span class="comment">    	  	</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="comment">// 文件名称（指定名称+目录）</span></span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/[name].[contenthash:8].js&#x27;</span>,</span><br><span class="line">        <span class="comment">// 输出文件目录（将来所有资源输出的公共目录）</span></span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="comment">// 所有资源引入的公共路径前缀 -&gt; &#x27;img/a.jpg&#x27; -&gt;&#x27;/img/a.jpg&#x27;</span></span><br><span class="line">        <span class="attr">publicPath</span>:<span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">        <span class="comment">// 非入口chunk的名称（指定名称+目录）</span></span><br><span class="line">        <span class="comment">// chunkFilename:&#x27;js/[name].[contenthash:8].js&#x27;,</span></span><br><span class="line">        <span class="comment">// 整个库向外暴露的变量名</span></span><br><span class="line">        <span class="comment">// library:&#x27;[name]&#x27;,</span></span><br><span class="line">        <span class="comment">// 变量名添加到哪个上</span></span><br><span class="line">        <span class="comment">// libraryTarget:&#x27;window&#x27;, 		// browser</span></span><br><span class="line">        <span class="comment">// libraryTarget:&#x27;global&#x27;, 		// node</span></span><br><span class="line">        <span class="comment">// libraryTarget:&#x27;commonjs&#x27;, 	// commonjs</span></span><br><span class="line">        <span class="comment">// 重新打包后清除上一次打包结果</span></span><br><span class="line">        <span class="comment">// clean:true,</span></span><br><span class="line">        <span class="comment">// 定义资源文件名（指定名称+目录）</span></span><br><span class="line">        <span class="comment">// assetModuleFilename:&#x27;asset/[contenthash].[ext]&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">      <span class="attr">rules</span>:[</span><br><span class="line">          <span class="comment">// loader的配置</span></span><br><span class="line">          &#123; </span><br><span class="line">              <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</span><br><span class="line">              loader: <span class="string">&quot;babel-loader&quot;</span>,</span><br><span class="line">              <span class="comment">// 排除node_modules下的js文件</span></span><br><span class="line">              <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">              <span class="comment">// 只检查src下的js文件</span></span><br><span class="line">              <span class="comment">// include:resolve(__dirname,&#x27;src&#x27;),</span></span><br><span class="line">              <span class="comment">// 优先执行</span></span><br><span class="line">              <span class="comment">// enforce:&#x27;pre&#x27;,</span></span><br><span class="line">              <span class="comment">// 延后执行</span></span><br><span class="line">              <span class="comment">// enforce:&#x27;post&#x27;,</span></span><br><span class="line">              <span class="comment">// 指定一些特殊配置</span></span><br><span class="line">              options: &#123;</span><br><span class="line">                  <span class="comment">// 预设</span></span><br><span class="line">                  <span class="attr">presets</span>:[<span class="string">&#x27;@babel/preset-env&#x27;</span>],</span><br><span class="line">                  <span class="comment">// babel缓存，第二次构建会读取之前的缓存</span></span><br><span class="line">                  <span class="attr">cacheDirectory</span>: <span class="literal">true</span></span><br><span class="line">              &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="comment">// 以下配置只会生效一个</span></span><br><span class="line">        	<span class="attr">oneOf</span>: [</span><br><span class="line">          		&#123; <span class="attr">test</span>: <span class="regexp">/\.html$/</span>, loader: <span class="string">&quot;html-loader&quot;</span> &#125;,</span><br><span class="line">          		&#123; </span><br><span class="line">                    <span class="attr">test</span>: <span class="regexp">/\.(png|svg)$/</span>, </span><br><span class="line">                    type: <span class="string">&quot;asset&quot;</span>, </span><br><span class="line">                    <span class="comment">// 定义资源名字的路径，优先级高于output内配置的资源路径和名称</span></span><br><span class="line">                    <span class="attr">generator</span>: &#123; </span><br><span class="line">                        <span class="attr">filename</span>: <span class="string">&quot;img/[name].[contenthash:8].[ext]&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123; <span class="attr">test</span>: <span class="regexp">/\.(ttf|woff)$/</span>, type: <span class="string">&quot;asset/resource&quot;</span>, <span class="attr">generator</span>: &#123; <span class="attr">filename</span>: <span class="string">&quot;fonts/[name].[contenthash:8].[ext]&quot;</span>&#125;&#125;,</span><br><span class="line">                &#123; <span class="attr">test</span>: <span class="regexp">/\.s?css$/</span>, use: [MiniCssExtractPlugin.loader, <span class="string">&quot;css-loader&quot;</span>, <span class="string">&quot;sass-loader&quot;</span>]&#125;,</span><br><span class="line">            ],</span><br><span class="line">          &#125;</span><br><span class="line">      ]  </span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        htmlPlugin,</span><br><span class="line">        miniCssExtractPlugin</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 解析模块的规则</span></span><br><span class="line">    <span class="attr">resolve</span>:&#123;</span><br><span class="line">        <span class="comment">// 配置解析模块路径别名：优点-&gt;可以简化路径，缺点-&gt;没有智能提示</span></span><br><span class="line">        <span class="attr">alias</span>:&#123;</span><br><span class="line">            <span class="string">&quot;@&quot;</span>: resolve(__dirname, <span class="string">&quot;src&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 配置省略文件路径的后缀名</span></span><br><span class="line">        <span class="attr">extensions</span>:[<span class="string">&#x27;.js&#x27;</span>,<span class="string">&#x27;.json&#x27;</span>],</span><br><span class="line">        <span class="comment">// 告诉webpack解析模块是去找哪个目录</span></span><br><span class="line">        <span class="attr">modules</span>:[<span class="string">&#x27;node_modules&#x27;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">optimization</span>:&#123;</span><br><span class="line">        <span class="attr">splitChunks</span>:&#123;</span><br><span class="line">            <span class="attr">chunks</span>:<span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">            <span class="comment">/* 以下内容全为默认值 */</span></span><br><span class="line">            <span class="attr">minSize</span>:<span class="number">30</span> * <span class="number">1024</span>,	<span class="comment">// 分割的chunk最小为30kb</span></span><br><span class="line">            <span class="attr">maxSize</span>:<span class="number">0</span>,	<span class="comment">// 没有最大限制</span></span><br><span class="line">            <span class="attr">minChunks</span>:<span class="number">1</span>,	<span class="comment">// 要提取的chunks最少被引用1次</span></span><br><span class="line">            <span class="attr">maxAsyncRequests</span>:<span class="number">5</span>,		<span class="comment">// 按需加载时并行加载的文件的最大数量</span></span><br><span class="line">            <span class="attr">maxInitialRequests</span>:<span class="number">3</span>,	<span class="comment">// 入口js文件最大并行请求数量</span></span><br><span class="line">            <span class="attr">automaticNameDelimiter</span>:<span class="string">&#x27;~&#x27;</span>,	<span class="comment">// 名称连接符</span></span><br><span class="line">            <span class="attr">name</span>:<span class="literal">true</span>,	<span class="comment">// 可以使用命名规则</span></span><br><span class="line">            <span class="attr">cacheGroups</span>:&#123;	<span class="comment">// 划分chunk的组</span></span><br><span class="line">                <span class="comment">// node_modules文件会被打包到vendors组的chunk中 -&gt; vendors~xxx.js</span></span><br><span class="line">                <span class="attr">vendors</span>:&#123;</span><br><span class="line">                    <span class="attr">test</span>:<span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">                    <span class="comment">// 优先级</span></span><br><span class="line">                    priority:-<span class="number">10</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">default</span>:&#123;</span><br><span class="line">                    <span class="comment">// 要提取的chunk最少被引用2次</span></span><br><span class="line">                    <span class="attr">minChunks</span>:<span class="number">2</span>,</span><br><span class="line">                    <span class="comment">// 优先级</span></span><br><span class="line">                    <span class="attr">priority</span>:-<span class="number">20</span>,</span><br><span class="line">                    <span class="comment">// 如果当前要打包的模块和之前已经被提取的模块是同一个，就会复用，而不是重新打包</span></span><br><span class="line">                    <span class="attr">reuseExistingChunk</span>:<span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 将当前模块的记录其他模块的hash单独打包为一个文件runtime</span></span><br><span class="line">        <span class="comment">// 解决：修改a文件导致b文件的contenthash变化</span></span><br><span class="line">        <span class="attr">runtimeChunk</span>:&#123;</span><br><span class="line">            <span class="attr">name</span>:<span class="function"><span class="params">entrypoint</span> =&gt;</span> <span class="string">`runtime-<span class="subst">$&#123;entrypoint.name&#125;</span>`</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 配置生产环境的压缩方案:主要针对js和css</span></span><br><span class="line">        <span class="attr">minimizer</span>:[</span><br><span class="line">    		cssMinimizerWebpackPlugin,</span><br><span class="line">            terserWebpackPlugin</span><br><span class="line">    	]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// devServer配置（详细配置请查看三.6）</span></span><br><span class="line">    <span class="attr">devServer</span>:&#123;</span><br><span class="line">        <span class="attr">static</span>:resolve(__dirname,<span class="string">&#x27;./dist&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">devtool</span>:<span class="string">&#x27;source-map&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="1-修改环境变量">
          <a href="#1-修改环境变量" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-修改环境变量" class="headerlink" title="1. 修改环境变量"></a>1. 修改环境变量</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 公共路径</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">env</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">		<span class="attr">mode</span>:env.production?<span class="string">&#x27;production&#x27;</span>:<span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">		<span class="attr">output</span>:&#123;</span><br><span class="line">			<span class="attr">filename</span>:<span class="string">&#x27;js/[name].[contenthash:8].js&#x27;</span>,</span><br><span class="line">			<span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">			<span class="comment">// 所有资源引入的公共路径前缀 -&gt; &#x27;img/a.jpg&#x27; -&gt;&#x27;/img/a.jpg&#x27;</span></span><br><span class="line">			<span class="attr">publicPath</span>:<span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">		...</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight shell"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 通过命令行修改环境变量</span></span><br><span class="line">npx webpack --env production</span><br></pre></td></tr></table></div></figure>


        <h2 id="2-开发环境基本配置">
          <a href="#2-开发环境基本配置" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-开发环境基本配置" class="headerlink" title="2.开发环境基本配置"></a>2.开发环境基本配置</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 开发环境配置webpack.config.dev.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> HtmlPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> htmlPlugin = <span class="keyword">new</span> HtmlPlugin(&#123;</span><br><span class="line">    <span class="attr">template</span>: <span class="string">&quot;./src/index.html&quot;</span>,</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;index.html&quot;</span>,</span><br><span class="line">    <span class="attr">inject</span>:<span class="string">&quot;body&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&quot;mini-css-extract-plugin&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> miniCssExtractPlugin = <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;css/[name].css&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/[name].js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="attr">clean</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">assetModuleFilename</span>:<span class="string">&#x27;asset/[contenthash].[ext]&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">      <span class="attr">rules</span>:[...]  </span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        htmlPlugin,</span><br><span class="line">        miniCssExtractPlugin</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">resolve</span>:&#123;</span><br><span class="line">        <span class="attr">alias</span>:&#123;</span><br><span class="line">            <span class="string">&quot;@&quot;</span>: resolve(__dirname, <span class="string">&quot;src&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">devtool</span>:<span class="string">&#x27;eval-cheap-module-source-map&#x27;</span>,</span><br><span class="line">    <span class="attr">optimization</span>:&#123;</span><br><span class="line">        <span class="attr">splitChunks</span>:&#123;</span><br><span class="line">            <span class="attr">cacheGroups</span>:&#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">             	name:<span class="string">&#x27;vendors&#x27;</span>,</span><br><span class="line">                <span class="attr">chunks</span>:<span class="string">&#x27;all&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">devServer</span>:&#123;</span><br><span class="line">        <span class="attr">static</span>:<span class="string">&#x27;./dist&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight shell"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 指定配置文件</span></span><br><span class="line">npx webpack --config webpack.config.dev.js</span><br><span class="line">npx webpakc serve --config webpack.config.dev.js</span><br></pre></td></tr></table></div></figure>


        <h2 id="3-生产环境基本配置">
          <a href="#3-生产环境基本配置" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-生产环境基本配置" class="headerlink" title="3.生产环境基本配置"></a>3.生产环境基本配置</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生产环境配置webpack.config.prod.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> HtmlPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlPlugin = <span class="keyword">new</span> HtmlPlugin(&#123;</span><br><span class="line">    <span class="attr">template</span>: <span class="string">&quot;./src/index.html&quot;</span>,</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;index.html&quot;</span>,</span><br><span class="line">    <span class="attr">inject</span>:<span class="string">&quot;body&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&quot;mini-css-extract-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> miniCssExtractPlugin = <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;css/[name].[contenthash:8].css&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> CssMinimizerWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;css-minimizer-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cssMinimizerWebpackPlugin = <span class="keyword">new</span> CssMinimizerWebpackPlugin();</span><br><span class="line"><span class="keyword">const</span> TerserWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;terser-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> terserWebpackPlugin = <span class="keyword">new</span> TerserWebpackPlugin(&#123;</span><br><span class="line">    <span class="attr">extractComments</span>: <span class="literal">false</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/[name].[contenthash:8].js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="attr">publicPath</span>:<span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">        <span class="attr">clean</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">assetModuleFilename</span>:<span class="string">&#x27;asset/[contenthash].[ext]&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">      <span class="attr">rules</span>:[...]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        htmlPlugin,</span><br><span class="line">        miniCssExtractPlugin</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">resolve</span>:&#123;</span><br><span class="line">        <span class="attr">alias</span>:&#123;</span><br><span class="line">            <span class="string">&quot;@&quot;</span>: resolve(__dirname, <span class="string">&quot;src&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">optimization</span>:&#123;</span><br><span class="line">        <span class="attr">splitChunks</span>:&#123;</span><br><span class="line">            <span class="attr">cacheGroups</span>:&#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">             	name:<span class="string">&#x27;vendors&#x27;</span>,</span><br><span class="line">                <span class="attr">chunks</span>:<span class="string">&#x27;all&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">minimizer</span>:[</span><br><span class="line">    		cssMinimizerWebpackPlugin,</span><br><span class="line">            terserWebpackPlugin</span><br><span class="line">    	]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">performance</span>:&#123;</span><br><span class="line">        <span class="attr">hits</span>:<span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight shell"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 指定配置文件</span></span><br><span class="line">npx webpack --config webpack.config.prod.js</span><br></pre></td></tr></table></div></figure>


        <h2 id="4-npm脚本">
          <a href="#4-npm脚本" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-npm脚本" class="headerlink" title="4.npm脚本"></a>4.npm脚本</h2>
      <figure class="highlight json"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;server&quot;</span>:<span class="string">&quot;npx webpakc serve --config webpack.config.dev.js&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;build&quot;</span>:<span class="string">&quot;npx webpack --config webpack.config.prod.js&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight shell"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 通过npm脚本运行</span></span><br><span class="line">npm run serve</span><br><span class="line">npm run build</span><br></pre></td></tr></table></div></figure>


        <h2 id="5-提取配置内公共代码">
          <a href="#5-提取配置内公共代码" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-提取配置内公共代码" class="headerlink" title="5.提取配置内公共代码"></a>5.提取配置内公共代码</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 公共环境配置webpack.config.common.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> HtmlPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlPlugin = <span class="keyword">new</span> HtmlPlugin(&#123;</span><br><span class="line">    <span class="attr">template</span>: <span class="string">&quot;./src/index.html&quot;</span>,</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;index.html&quot;</span>,</span><br><span class="line">    <span class="attr">inject</span>:<span class="string">&quot;body&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&quot;mini-css-extract-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> miniCssExtractPlugin = <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;css/[name].[contenthash:8].css&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="attr">clean</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">assetModuleFilename</span>:<span class="string">&#x27;asset/[contenthash].[ext]&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">      <span class="attr">rules</span>:[</span><br><span class="line">          &#123; </span><br><span class="line">              <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</span><br><span class="line">              loader: <span class="string">&quot;babel-loader&quot;</span>,</span><br><span class="line">              <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">              options: &#123;</span><br><span class="line">                  <span class="attr">presets</span>:[<span class="string">&#x27;@babel/preset-env&#x27;</span>],</span><br><span class="line">                  <span class="attr">cacheDirectory</span>: <span class="literal">true</span></span><br><span class="line">              &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">        	<span class="attr">oneOf</span>: [</span><br><span class="line">          		&#123; <span class="attr">test</span>: <span class="regexp">/\.html$/</span>, loader: <span class="string">&quot;html-loader&quot;</span> &#125;,</span><br><span class="line">          		&#123; <span class="attr">test</span>: <span class="regexp">/\.(png|svg)$/</span>, type: <span class="string">&quot;asset&quot;</span>, <span class="attr">generator</span>: &#123; <span class="attr">filename</span>: <span class="string">&quot;img/[name].[contenthash:8].[ext]&quot;</span>&#125;&#125;,</span><br><span class="line">                &#123; <span class="attr">test</span>: <span class="regexp">/\.(ttf|woff)$/</span>, type: <span class="string">&quot;asset/resource&quot;</span>, <span class="attr">generator</span>: &#123; <span class="attr">filename</span>: <span class="string">&quot;fonts/[name].[contenthash:8].[ext]&quot;</span>&#125;&#125;,</span><br><span class="line">                &#123; <span class="attr">test</span>: <span class="regexp">/\.s?css$/</span>, use: [MiniCssExtractPlugin.loader, <span class="string">&quot;css-loader&quot;</span>, <span class="string">&quot;sass-loader&quot;</span>]&#125;,</span><br><span class="line">            ],</span><br><span class="line">          &#125;</span><br><span class="line">      ]  </span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        htmlPlugin,</span><br><span class="line">        miniCssExtractPlugin</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">resolve</span>:&#123;</span><br><span class="line">        <span class="attr">alias</span>:&#123;</span><br><span class="line">            <span class="string">&quot;@&quot;</span>: resolve(__dirname, <span class="string">&quot;src&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">optimization</span>:&#123;</span><br><span class="line">        <span class="attr">splitChunks</span>:&#123;</span><br><span class="line">            <span class="attr">cacheGroups</span>:&#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">             	name:<span class="string">&#x27;vendors&#x27;</span>,</span><br><span class="line">                <span class="attr">chunks</span>:<span class="string">&#x27;all&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 开发环境配置webpack.config.dev.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/[name].js&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">devtool</span>:<span class="string">&#x27;eval-cheap-module-source-map&#x27;</span>,</span><br><span class="line">    <span class="attr">devServer</span>:&#123;</span><br><span class="line">        <span class="attr">static</span>:<span class="string">&#x27;./dist&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生产环境配置webpack.config.prod.js</span></span><br><span class="line"><span class="keyword">const</span> CssMinimizerWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;css-minimizer-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cssMinimizerWebpackPlugin = <span class="keyword">new</span> CssMinimizerWebpackPlugin();</span><br><span class="line"><span class="keyword">const</span> TerserWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;terser-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> terserWebpackPlugin = <span class="keyword">new</span> TerserWebpackPlugin(&#123;</span><br><span class="line">    <span class="attr">extractComments</span>: <span class="literal">false</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/[name].[contenthash:8].js&#x27;</span>,</span><br><span class="line">        <span class="attr">publicPath</span>:<span class="string">&#x27;/&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">optimization</span>:&#123;</span><br><span class="line">        <span class="attr">minimizer</span>:[</span><br><span class="line">    		cssMinimizerWebpackPlugin,</span><br><span class="line">            terserWebpackPlugin</span><br><span class="line">    	]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">performance</span>:&#123;</span><br><span class="line">        <span class="attr">hits</span>:<span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight shell"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装webpack-merge包</span></span><br><span class="line">npm install webpack-merge -D</span><br></pre></td></tr></table></div></figure>

<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> &#123;merge&#125; = <span class="built_in">require</span>(<span class="string">&#x27;webpack-merge&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> commonConfig = reuqire(<span class="string">&#x27;./webpack.config.common&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> productionConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.config.prod&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> developmentConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.config.dev&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">env</span>) =&gt;</span>&#123;</span><br><span class="line">    <span class="function"><span class="title">swicth</span>(<span class="params"><span class="literal">true</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">case</span> env.development:</span><br><span class="line">        	<span class="keyword">return</span> merge(commonConfig,developmentConfig)</span><br><span class="line">        <span class="keyword">case</span> env.production:</span><br><span class="line">        	<span class="keyword">return</span> merge(commonConfig,productionConfig)</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">        	<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;No matching configuration was found&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight json"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json修改npm脚本</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;server&quot;</span>:<span class="string">&quot;npx webpakc serve --config webpack.config.js --env development&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;build&quot;</span>:<span class="string">&quot;npx webpack --config webpack.config.js --env production&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h1 id="六-vue-cli构建打包配置分析">
          <a href="#六-vue-cli构建打包配置分析" class="heading-link"><i class="fas fa-link"></i></a><a href="#六-vue-cli构建打包配置分析" class="headerlink" title="六.vue-cli构建打包配置分析"></a>六.vue-cli构建打包配置分析</h1>
      <figure class="highlight shell"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 将vue开发环境的webpack配置输出</span></span><br><span class="line">npx vue-cli-service inspect --mode=development &gt; webpack.dev.js</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将vue生产环境的webpack配置输出</span></span><br><span class="line">npx vue-cli-service inspect --mode=production &gt; webpack.prod.js</span><br></pre></td></tr></table></div></figure>



<hr>
<p><strong>注意：</strong>以上内容大部分为<code>Webpack5</code>，部分配置可能是<code>Webpack4</code>的配置，已经不适用新版本，需自行调整</p>
<hr>
<blockquote>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1YU4y1g745">https://www.bilibili.com/video/BV1YU4y1g745</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ 本文结束，感谢您的阅读 ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">本文作者: </span><span class="copyright-author__value"><a href="https://lonelytaker.cn">LonelyTaker</a></span></div><div class="copyright-link"><span class="copyright-link__name">本文链接: </span><span class="copyright-link__value"><a href="https://lonelytaker.cn/2022/01/24/webpack/">https://lonelytaker.cn/2022/01/24/webpack/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">版权声明: </span><span class="copyright-notice__value">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> 许可协议。转载请注明出处！</span></div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://lonelytaker.cn/tags/%E5%B7%A5%E5%85%B7/">工具</a></span></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2022/01/29/ES6%E6%A8%A1%E5%9D%97%E4%B8%8ECommonJS%E6%A8%A1%E5%9D%97%E7%9A%84%E5%8C%BA%E5%88%AB/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">ES6模块与CommonJS模块的区别</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2022/01/24/axios/"><span class="paginator-prev__text">axios</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目录</span><span class="sidebar-nav-ov">站点概览</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80-%E7%AE%80%E4%BB%8B"><span class="toc-text">
          一.简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C-Webpack%E4%BA%94%E4%B8%AA%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-text">
          二.Webpack五个核心概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Entry"><span class="toc-text">
          1.Entry</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Output"><span class="toc-text">
          2.Output</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Loader"><span class="toc-text">
          3.Loader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Plugins"><span class="toc-text">
          4.Plugins</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Mode"><span class="toc-text">
          5.Mode</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89-%E5%AD%A6%E4%B9%A0"><span class="toc-text">
          三.学习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%88%9D%E4%BD%93%E9%AA%8C"><span class="toc-text">
          1.初体验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%89%93%E5%8C%85%E6%A0%B7%E5%BC%8F%E8%B5%84%E6%BA%90"><span class="toc-text">
          2.打包样式资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%93%E5%8C%85html%E8%B5%84%E6%BA%90"><span class="toc-text">
          3.打包html资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%89%93%E5%8C%85%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90"><span class="toc-text">
          4.打包图片资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%89%93%E5%8C%85%E5%85%B6%E4%BB%96%E8%B5%84%E6%BA%90"><span class="toc-text">
          5.打包其他资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-devServer"><span class="toc-text">
          6.devServer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%8F%90%E5%8F%96css%E6%88%90%E5%8D%95%E7%8B%AC%E6%96%87%E4%BB%B6%E5%8F%8Acss%E5%85%BC%E5%AE%B9%E6%80%A7%E5%A4%84%E7%90%86"><span class="toc-text">
          7.提取css成单独文件及css兼容性处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-css%E5%8E%8B%E7%BC%A9"><span class="toc-text">
          8.css压缩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-js%E7%9A%84%E5%85%BC%E5%AE%B9%E6%80%A7%E5%A4%84%E7%90%86"><span class="toc-text">
          9.js的兼容性处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-js%E7%9A%84%E8%AF%AD%E6%B3%95%E6%A3%80%E6%9F%A5"><span class="toc-text">
          10.js的语法检查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-html%E5%92%8Cjs%E7%9A%84%E5%8E%8B%E7%BC%A9"><span class="toc-text">
          11.html和js的压缩</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B-Webpack%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-text">
          四.Webpack性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-text">
          1.开发环境性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%83%AD%E6%9B%BF%E6%8D%A2"><span class="toc-text">
          (1) 热替换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%83%AD%E5%8A%A0%E8%BD%BD"><span class="toc-text">
          (2) 热加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-source-map"><span class="toc-text">
          (3) source-map</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-text">
          2.生产环境性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-oneOf-%E7%BC%93%E5%AD%98-tree-shaking"><span class="toc-text">
          (1) oneOf&#x2F;缓存&#x2F;tree shaking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%A3%E7%A0%81%E5%88%86%E5%89%B2"><span class="toc-text">
          (2) 代码分割</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%87%92%E5%8A%A0%E8%BD%BD-%E9%A2%84%E5%8A%A0%E8%BD%BD"><span class="toc-text">
          (3) 懒加载&#x2F;预加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-PWA-%E6%B8%90%E8%BF%9B%E5%BC%8F%E7%BD%91%E7%BB%9C%E5%BC%80%E5%8F%91%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"><span class="toc-text">
          (4) PWA(渐进式网络开发应用程序)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%A4%9A%E8%BF%9B%E7%A8%8B%E6%89%93%E5%8C%85"><span class="toc-text">
          (5) 多进程打包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-externals"><span class="toc-text">
          (6) externals</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-dll"><span class="toc-text">
          (7) dll</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E7%BB%93"><span class="toc-text">
          3.性能优化总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-text">
          开发环境性能优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-text">
          生产环境性能优化</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94-Webpack%E8%AF%A6%E7%BB%86%E9%85%8D%E7%BD%AE"><span class="toc-text">
          五.Webpack详细配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BF%AE%E6%94%B9%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-text">
          1. 修改环境变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE"><span class="toc-text">
          2.开发环境基本配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE"><span class="toc-text">
          3.生产环境基本配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-npm%E8%84%9A%E6%9C%AC"><span class="toc-text">
          4.npm脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%8F%90%E5%8F%96%E9%85%8D%E7%BD%AE%E5%86%85%E5%85%AC%E5%85%B1%E4%BB%A3%E7%A0%81"><span class="toc-text">
          5.提取配置内公共代码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD-vue-cli%E6%9E%84%E5%BB%BA%E6%89%93%E5%8C%85%E9%85%8D%E7%BD%AE%E5%88%86%E6%9E%90"><span class="toc-text">
          六.vue-cli构建打包配置分析</span></a></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/image/site/head.png" alt="avatar"></div><p class="sidebar-ov-author__text">hello world</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/LonelyTaker" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="Ym1104340863" target="_blank" rel="noopener" data-popover="微信" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-weixin"></i></span></a><a class="sidebar-ov-social-item" href="1104340863" target="_blank" rel="noopener" data-popover="QQ" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-qq"></i></span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">9</div><div class="sidebar-ov-state-item__name">归档</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">4</div><div class="sidebar-ov-state-item__name">分类</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">4</div><div class="sidebar-ov-state-item__name">标签</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知识共享许可协议" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">你已阅读了 </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2022</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>LonelyTaker</span></div><div><span>由 <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> 强力驱动</span><span> v6.0.0</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script></body></html>