<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>webpack | LonelyTaker&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Webpack学习一.简介webpack是一个构建工具，是一个静态模块打包器(module bundler)。 二.Webpack五个核心概念1.Entry入口，指示Webpack以哪个文件为入口起点开始打包，分析构建内部依赖图 2.Output输出，指示Webpack打包后的资源bundles输出到哪里去，以及如何命名。 3.LoaderLoader让Webpack能够去处理那些非JavaScr">
<meta property="og:type" content="article">
<meta property="og:title" content="webpack">
<meta property="og:url" content="http://example.com/2022/01/24/webpack/index.html">
<meta property="og:site_name" content="LonelyTaker&#39;s Blog">
<meta property="og:description" content="Webpack学习一.简介webpack是一个构建工具，是一个静态模块打包器(module bundler)。 二.Webpack五个核心概念1.Entry入口，指示Webpack以哪个文件为入口起点开始打包，分析构建内部依赖图 2.Output输出，指示Webpack打包后的资源bundles输出到哪里去，以及如何命名。 3.LoaderLoader让Webpack能够去处理那些非JavaScr">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-01-24T02:09:12.000Z">
<meta property="article:modified_time" content="2022-01-24T02:09:26.021Z">
<meta property="article:author" content="LonelyTaker">
<meta property="article:tag" content="个人博客">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="LonelyTaker's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">LonelyTaker&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-webpack" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/01/24/webpack/" class="article-date">
  <time class="dt-published" datetime="2022-01-24T02:09:12.000Z" itemprop="datePublished">2022-01-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      webpack
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Webpack学习"><a href="#Webpack学习" class="headerlink" title="Webpack学习"></a>Webpack学习</h1><h2 id="一-简介"><a href="#一-简介" class="headerlink" title="一.简介"></a>一.简介</h2><p>webpack是一个构建工具，是一个静态模块打包器(module bundler)。</p>
<h2 id="二-Webpack五个核心概念"><a href="#二-Webpack五个核心概念" class="headerlink" title="二.Webpack五个核心概念"></a>二.Webpack五个核心概念</h2><h3 id="1-Entry"><a href="#1-Entry" class="headerlink" title="1.Entry"></a>1.Entry</h3><p>入口，指示Webpack以哪个文件为入口起点开始打包，分析构建内部依赖图</p>
<h3 id="2-Output"><a href="#2-Output" class="headerlink" title="2.Output"></a>2.Output</h3><p>输出，指示Webpack打包后的资源bundles输出到哪里去，以及如何命名。</p>
<h3 id="3-Loader"><a href="#3-Loader" class="headerlink" title="3.Loader"></a>3.Loader</h3><p>Loader让Webpack能够去处理那些非JavaScript文件(webpack自身只能理解JavaScript)</p>
<h3 id="4-Plugins"><a href="#4-Plugins" class="headerlink" title="4.Plugins"></a>4.Plugins</h3><p>插件可以用执行范围更广的任务。插件的范围包括：从打包优化和压缩，一直到重新定义环境中的变量等。</p>
<h3 id="5-Mode"><a href="#5-Mode" class="headerlink" title="5.Mode"></a>5.Mode</h3><p>模式指示Webpack使用相应模式的配置。</p>
<ul>
<li>development - 开发模式</li>
<li>production - 生产模式</li>
</ul>
<h2 id="三-学习"><a href="#三-学习" class="headerlink" title="三.学习"></a>三.学习</h2><h3 id="1-初体验"><a href="#1-初体验" class="headerlink" title="1.初体验"></a>1.初体验</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* webpack入口文件index.js */</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">运行指令</span><br><span class="line">开发环境: webpack ./index.js -o ./build/built.js --mode=development</span><br><span class="line">	webpack会以index.js为入口文件开始打包，打包后输出到./build/built.js</span><br><span class="line">	整体打包环境是开发环境</span><br><span class="line">生产环境: webpack ./index.js -o ./build/built.js --mode=production</span><br></pre></td></tr></table></figure>

<p>结论：</p>
<ul>
<li>webpack可以处理js/json资源，不能处理css/img等其他资源</li>
<li>生产环境和开发环境能将ES6模块化编译成浏览器能识别的模块化</li>
<li>生产环境比开发环境多一个压缩js代码</li>
</ul>
<h3 id="2-打包样式资源"><a href="#2-打包样式资源" class="headerlink" title="2.打包样式资源"></a>2.打包样式资源</h3><p>webpack.config.js，webpack的配置文件</p>
<p>模块化默认采用commonJS，因为所有构建工具都是基于Nodejs平台运行的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// resolve用来拼接绝对路径的方法</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="comment">// 入口起点</span></span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="comment">// 输出</span></span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="comment">// 输出文件名</span></span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="comment">// 输出路径</span></span><br><span class="line">        <span class="comment">// __dirname代表当前文件目录的绝对路径</span></span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="comment">// loader的配置</span></span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">            <span class="comment">// 详细loader配置</span></span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="comment">// 匹配哪些文件</span></span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                <span class="comment">// 使用哪些loader进行处理</span></span><br><span class="line">                use:[</span><br><span class="line">                    <span class="comment">// use数组中loader执行顺序：从右到左(从下到上)依次执行</span></span><br><span class="line">                    <span class="comment">// 创建style标签，将js中的样式资源插入进行，添加到head中生效</span></span><br><span class="line">                    <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">                    <span class="comment">// 将css文件变成commonjs模块加载到js中，里面内容是样式字符串</span></span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.less$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">                    <span class="comment">// 将less文件编译成css文件</span></span><br><span class="line">                    <span class="string">&#x27;less-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="comment">// plugins的配置</span></span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        </span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 模式(development 或 production)</span></span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-打包html资源"><a href="#3-打包html资源" class="headerlink" title="3.打包html资源"></a>3.打包html资源</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	loader: 1.下载 2.使用(配置)</span></span><br><span class="line"><span class="comment">	plugins: 1.下载 2.引入 3.使用</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="comment">// loader的配置</span></span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="comment">// plugins的配置</span></span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="comment">// 默认会创建一个空的html，自动引入打包输出的所有资源(JS/CSS)</span></span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="comment">// 复制 &#x27;./src/index.html&#x27;文件，并自动引入打包输出的所有资源(JS/CSS)</span></span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 模式(development 或 production)</span></span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-打包图片资源"><a href="#4-打包图片资源" class="headerlink" title="4.打包图片资源"></a>4.打包图片资源</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="comment">// loader的配置</span></span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;	</span><br><span class="line">                <span class="comment">// 问题：默认处理不了Html中的img图片</span></span><br><span class="line">                <span class="comment">// 处理图片资源</span></span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.(jpg|png|gif)$/</span>,</span><br><span class="line">                <span class="comment">// 只使用一个loader可以直接使用loader:&#x27;&#x27;</span></span><br><span class="line">                loader:<span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>:&#123;</span><br><span class="line">                    <span class="comment">// 图片大小小于8kb，就会被base64处理</span></span><br><span class="line">                    <span class="comment">// 优点:减少请求数量(减轻服务器压力)</span></span><br><span class="line">                    <span class="comment">// 缺点:图片体积会更大(文件请求速度更慢)</span></span><br><span class="line">                    <span class="attr">limit</span>:<span class="number">8</span>*<span class="number">1024</span>,</span><br><span class="line">                    <span class="comment">// 问题:因为url-loader默认使用es6模块化解析，而html-loader引入图片是commonjs，解析时会出问题</span></span><br><span class="line">                    <span class="comment">// 解决：关闭url-loader的es6模块化解析，使用commonjs解析</span></span><br><span class="line">                    <span class="attr">esModule</span>:<span class="literal">false</span>,</span><br><span class="line">                    <span class="comment">// 给图片重命名</span></span><br><span class="line">                    <span class="comment">// [hash:10]取图片hash的前10位</span></span><br><span class="line">                    <span class="comment">// [ext]取文件原来扩展名</span></span><br><span class="line">                    <span class="attr">name</span>:<span class="string">&#x27;[hash:10].[ext]&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.html$/</span>,</span><br><span class="line">                <span class="comment">// 处理Html文件的img图片(负责引入img,从而能够被url-loader进行处理)</span></span><br><span class="line">                loader:<span class="string">&#x27;html-loader&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="comment">// plugins的配置</span></span><br><span class="line">    <span class="attr">plugins</span>:[],</span><br><span class="line">    <span class="comment">// 模式(development 或 production)</span></span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-打包其他资源"><a href="#5-打包其他资源" class="headerlink" title="5.打包其他资源"></a>5.打包其他资源</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// 打包其他资源(除了html/js/css资源以外的资源)</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 排除html/js/css资源以外的资源</span></span><br><span class="line">                <span class="attr">exclude</span>:<span class="regexp">/\.(css|js|html)$/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;file-loader&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-devServer"><a href="#6-devServer" class="headerlink" title="6.devServer"></a>6.devServer</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;...&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[...]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[...],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">    <span class="comment">// 作用：自动化(自动编译，自动打开浏览器，自动刷新浏览器......)</span></span><br><span class="line">    <span class="comment">// 特点：只会在内存中编译打包，不会有任何输出</span></span><br><span class="line">    <span class="comment">// 启动devServer指令为:npx webpack-dev-server(需要下载)</span></span><br><span class="line">    <span class="attr">devServer</span>:&#123;</span><br><span class="line">        <span class="comment">// 构建后路径</span></span><br><span class="line">        <span class="attr">contentBase</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>),</span><br><span class="line">        <span class="comment">// 启动gzip压缩</span></span><br><span class="line">        <span class="attr">compress</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 端口号</span></span><br><span class="line">        <span class="attr">port</span>:<span class="number">3000</span>,</span><br><span class="line">        <span class="comment">// 自动打开浏览器</span></span><br><span class="line">        <span class="attr">open</span>:<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-开发环境的基本配置"><a href="#7-开发环境的基本配置" class="headerlink" title="7.开发环境的基本配置"></a>7.开发环境的基本配置</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">	开发环境配置</span></span><br><span class="line"><span class="comment">		运行项目指令:</span></span><br><span class="line"><span class="comment">			webpack 会将打包结果输出</span></span><br><span class="line"><span class="comment">			npx webpack-dev-server 只会在内存中打包，不会输出</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,	<span class="comment">// 可以加文件夹js/built.js，即打包到build/js文件夹下</span></span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[<span class="string">&#x27;style-loader&#x27;</span>,<span class="string">&#x27;css-loader&#x27;</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.less$/</span>,</span><br><span class="line">                use:[<span class="string">&#x27;style-loader&#x27;</span>,<span class="string">&#x27;css-loader&#x27;</span>,<span class="string">&#x27;less-loader&#x27;</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.(jpg|png|gif)$/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>:&#123;</span><br><span class="line">                    <span class="attr">limit</span>:<span class="number">8</span>*<span class="number">1024</span>,</span><br><span class="line">                    <span class="attr">esModule</span>:<span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">name</span>:<span class="string">&#x27;[hash:10].[ext]&#x27;</span>,</span><br><span class="line">                    <span class="comment">// outputPath属性，在目标文件夹下再创建一个文件夹</span></span><br><span class="line">                    <span class="attr">outputPath</span>:<span class="string">&#x27;img&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.html$/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;html-loader&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">exclude</span>:<span class="regexp">/\.(css|less|js|html|jpg|png|gif)$/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;file-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>:&#123;</span><br><span class="line">                    <span class="attr">outputPath</span>:<span class="string">&#x27;media&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">devServer</span>:&#123;</span><br><span class="line">        <span class="attr">contentBase</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>),</span><br><span class="line">        <span class="attr">compress</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">port</span>:<span class="number">3000</span>,</span><br><span class="line">        <span class="attr">open</span>:<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-提取css成单独文件及css兼容性处理"><a href="#8-提取css成单独文件及css兼容性处理" class="headerlink" title="8.提取css成单独文件及css兼容性处理"></a>8.提取css成单独文件及css兼容性处理</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置nodejs环境变量，决定使用browserslist的哪个环境</span></span><br><span class="line">process.env,NODE_ENV = <span class="string">&#x27;development&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,	<span class="comment">// 可以加文件夹js/built.js，即打包到build/js文件夹下</span></span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    <span class="comment">// &#x27;style-loader&#x27;,</span></span><br><span class="line">                    <span class="comment">// 这个loader代替style-loader，将js中的css提取成单独文件</span></span><br><span class="line">                    MiniCssExtractPlugin.loader,</span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span>，</span><br><span class="line">                    <span class="comment">/*</span></span><br><span class="line"><span class="comment">                    	css兼容性处理:postcss --&gt; postcss-loader postcss-preset-env</span></span><br><span class="line"><span class="comment">                    	帮postcss找到package.json中browserslist里面的配置，通过配置加载指定的css兼容性样式</span></span><br><span class="line"><span class="comment">                    */</span></span><br><span class="line">                    <span class="comment">// 1.使用loader的默认配置</span></span><br><span class="line">                    <span class="comment">// &#x27;postcss-loader&#x27;,</span></span><br><span class="line">                    <span class="comment">// 2.修改loader的配置,</span></span><br><span class="line">                    &#123;</span><br><span class="line">                    	<span class="attr">loader</span>:<span class="string">&#x27;postcss-loader&#x27;</span>,</span><br><span class="line">                    	<span class="attr">options</span>:&#123;</span><br><span class="line">                    		<span class="attr">ident</span>:<span class="string">&#x27;postcss&#x27;</span>,</span><br><span class="line">                    		<span class="attr">plugins</span>:<span class="function">()=&gt;</span>[</span><br><span class="line">                				<span class="comment">// postcss的插件</span></span><br><span class="line">                				<span class="built_in">require</span>(<span class="string">&#x27;postcss-preset-env&#x27;</span>)()</span><br><span class="line">                			]</span><br><span class="line">                    	&#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            <span class="attr">filename</span>:<span class="string">&#x27;css/built.css&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">devServer</span>:&#123;</span><br><span class="line">        <span class="attr">contentBase</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>),</span><br><span class="line">        <span class="attr">compress</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">port</span>:<span class="number">3000</span>,</span><br><span class="line">        <span class="attr">open</span>:<span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;name&quot;</span>: <span class="string">&quot;webpack&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;main&quot;</span>: <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    	<span class="attr">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  	&#125;,</span><br><span class="line">  	<span class="attr">&quot;author&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;license&quot;</span>: <span class="string">&quot;ISC&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;devDependencies&quot;</span>: &#123;...&#125;,</span><br><span class="line">  	<span class="attr">&quot;browserslist&quot;</span>:&#123;</span><br><span class="line">    	<span class="comment">// 开发环境</span></span><br><span class="line">    	<span class="attr">&quot;development&quot;</span>:[</span><br><span class="line">        	<span class="string">&quot;last 1 chrome version&quot;</span>,</span><br><span class="line">        	<span class="string">&quot;last 1 firefox version&quot;</span>,</span><br><span class="line">        	<span class="string">&quot;last 1 safari version&quot;</span>,</span><br><span class="line">    	],</span><br><span class="line">    	<span class="comment">// 生产环境(默认)</span></span><br><span class="line">    	<span class="attr">&quot;production&quot;</span>:[</span><br><span class="line">        	<span class="string">&quot;&gt;0.2%&quot;</span>,</span><br><span class="line">        	<span class="string">&quot;not dead&quot;</span>,</span><br><span class="line">        	<span class="string">&quot;not op_mini all&quot;</span></span><br><span class="line">    	]</span><br><span class="line">  	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="9-css压缩"><a href="#9-css压缩" class="headerlink" title="9.css压缩"></a>9.css压缩</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> OptimizeCssAssetsWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    MiniCssExtractPlugin.loader,</span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            <span class="attr">filename</span>:<span class="string">&#x27;css/built.css&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">// 压缩css</span></span><br><span class="line">        <span class="keyword">new</span> OptimizeCssAssetsWebpackPlugin()</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="10-js的语法检查"><a href="#10-js的语法检查" class="headerlink" title="10.js的语法检查"></a>10.js的语法检查</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                	语法检查：eslint-loader eslint</span></span><br><span class="line"><span class="comment">                	注意：只检查自己写的源代码，第三方库不用检查</span></span><br><span class="line"><span class="comment">                	设置检查规则:</span></span><br><span class="line"><span class="comment">                		package.json中eslintConfig中设置</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.js$/</span>,</span><br><span class="line">                exclude:<span class="regexp">/node_modules/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;eslint-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>:&#123;</span><br><span class="line">                    <span class="comment">// 自动修复</span></span><br><span class="line">                    <span class="attr">fix</span>:<span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;name&quot;</span>: <span class="string">&quot;webpack&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;main&quot;</span>: <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    	<span class="attr">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  	&#125;,</span><br><span class="line">  	<span class="attr">&quot;author&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;license&quot;</span>: <span class="string">&quot;ISC&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;devDependencies&quot;</span>: &#123;...&#125;,</span><br><span class="line">  	<span class="attr">&quot;browserslist&quot;</span>:&#123;</span><br><span class="line">    	<span class="attr">&quot;development&quot;</span>:[...],</span><br><span class="line">    	<span class="attr">&quot;production&quot;</span>:[...]</span><br><span class="line">  	&#125;,</span><br><span class="line">    <span class="attr">&quot;eslintConfig&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;extends&quot;</span>:<span class="string">&quot;airbnb-base&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="11-js的兼容性处理"><a href="#11-js的兼容性处理" class="headerlink" title="11.js的兼容性处理"></a>11.js的兼容性处理</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		<span class="comment">/*</span></span><br><span class="line"><span class="comment">    			js兼容性处理:babel-loader</span></span><br><span class="line"><span class="comment">    				*1.基本js兼容性处理 --&gt; @babel/preset-env</span></span><br><span class="line"><span class="comment">    					问题：只能转换基本语法，如promise不能转换</span></span><br><span class="line"><span class="comment">    				2.全部js兼容性处理 --&gt; @babel/polyfill</span></span><br><span class="line"><span class="comment">    					问题：只要解决部分兼容问题时，但是将所有兼容性代码全部引入，体积太大</span></span><br><span class="line"><span class="comment">    				*3.按需加载 --&gt; corejs</span></span><br><span class="line"><span class="comment">    		*/</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.js$/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">exclude</span>:<span class="regexp">/node_modules/</span>,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    <span class="comment">// 预设：指示babel做怎么样的兼容性处理</span></span><br><span class="line">                    <span class="comment">// presets:[&#x27;@babel/preset-env&#x27;]</span></span><br><span class="line">                    <span class="attr">presets</span>:[</span><br><span class="line">                        [</span><br><span class="line">                            <span class="string">&#x27;@babel/preset-env&#x27;</span>,</span><br><span class="line">                        	&#123;</span><br><span class="line">                            	<span class="attr">useBuiltIns</span>:<span class="string">&#x27;usage&#x27;</span>,</span><br><span class="line">                            	<span class="comment">// 指定core-js版本</span></span><br><span class="line">                            	<span class="attr">corejs</span>:&#123;</span><br><span class="line">                               	 	<span class="attr">version</span>:<span class="number">3</span></span><br><span class="line">                            	&#125;,</span><br><span class="line">                            	<span class="comment">// 指定兼容性做到哪个版本浏览器</span></span><br><span class="line">                            	<span class="attr">targets</span>:&#123;</span><br><span class="line">                                	<span class="attr">chrome</span>:<span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">                                	<span class="attr">firefox</span>:<span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">                                	<span class="attr">ie</span>:<span class="string">&#x27;10&#x27;</span>,</span><br><span class="line">                                	<span class="attr">safari</span>:<span class="string">&#x27;10&#x27;</span>,</span><br><span class="line">                                	<span class="attr">edge</span>:<span class="string">&#x27;17&#x27;</span>,</span><br><span class="line">                            	&#125;</span><br><span class="line">                        	&#125;</span><br><span class="line">                    	]</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        </span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="12-html和js的压缩"><a href="#12-html和js的压缩" class="headerlink" title="12.html和js的压缩"></a>12.html和js的压缩</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span>,</span><br><span class="line">            <span class="attr">minify</span>:&#123;</span><br><span class="line">                <span class="comment">// 移除空格</span></span><br><span class="line">                <span class="attr">collapseWhitespace</span>:<span class="literal">true</span>,</span><br><span class="line">                <span class="comment">// 移除注释</span></span><br><span class="line">                <span class="attr">removeComments</span>:<span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        </span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 生产环境下会自动压缩js代码</span></span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="13-生产环境的基本配置"><a href="#13-生产环境的基本配置" class="headerlink" title="13.生产环境的基本配置"></a>13.生产环境的基本配置</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> OptimizeCssAssetsWebpackPlugin= <span class="built_in">require</span>(<span class="string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin= <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line">process.env.NODE_ENV = <span class="string">&#x27;production&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 复用loader</span></span><br><span class="line"><span class="keyword">const</span> commonCssLoader = [</span><br><span class="line">    MiniCssExtractPlugin.loader,</span><br><span class="line">    <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="attr">loader</span>:<span class="string">&#x27;postcss-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">options</span>:&#123;</span><br><span class="line">        	<span class="attr">ident</span>:<span class="string">&#x27;postcss&#x27;</span>,</span><br><span class="line">            <span class="attr">plugins</span>:<span class="function">()=&gt;</span>[</span><br><span class="line">            	<span class="built_in">require</span>(<span class="string">&#x27;postcss-preset-env&#x27;</span>)()</span><br><span class="line">            ]</span><br><span class="line">     	&#125;</span><br><span class="line">     &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">        <span class="attr">rules</span>:[</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/.css$/</span>,</span><br><span class="line">                use:[...commonCssLoader]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/.less$/</span>,</span><br><span class="line">                use:[...commonCssLoader,<span class="string">&#x27;less-loader&#x27;</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            	正常来讲，一个文件只能被一个loader处理</span></span><br><span class="line"><span class="comment">            	当一个文件被多个loader处理，那么一定要指定loader执行的先后顺序:</span></span><br><span class="line"><span class="comment">            		先执行eslint再执行babel</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.js$/</span>,</span><br><span class="line">                exclude:<span class="regexp">/node_modules/</span>,</span><br><span class="line">                <span class="comment">// 优先执行</span></span><br><span class="line">                enforce:<span class="string">&#x27;pre&#x27;</span>,</span><br><span class="line">                <span class="attr">loader</span>:<span class="string">&#x27;eslint-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>:&#123;</span><br><span class="line">                    <span class="attr">fix</span>:<span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.js$/</span>,</span><br><span class="line">                exclude:<span class="regexp">/node_modules/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>:&#123;</span><br><span class="line">                    <span class="attr">presets</span>:[</span><br><span class="line">                        [</span><br><span class="line">                            <span class="string">&#x27;@babel/preset-env&#x27;</span>,</span><br><span class="line">                         	&#123;</span><br><span class="line">                                <span class="attr">useBuiltIns</span>:<span class="string">&#x27;usage&#x27;</span>,</span><br><span class="line">                                <span class="attr">corejs</span>:&#123;<span class="attr">version</span>:<span class="number">3</span>&#125;,</span><br><span class="line">                                <span class="attr">targets</span>:&#123;</span><br><span class="line">                                    <span class="attr">chrome</span>:<span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">                                    <span class="attr">firefox</span>:<span class="string">&#x27;50&#x27;</span></span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        ]</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.(jpg|png|gif)$/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>:&#123;</span><br><span class="line">                    <span class="attr">limit</span>:<span class="number">8</span>*<span class="number">1024</span>,</span><br><span class="line">                    <span class="attr">name</span>:<span class="string">&#x27;[hash:10].[ext]&#x27;</span>,</span><br><span class="line">                    <span class="attr">outputPath</span>:<span class="string">&#x27;imgs&#x27;</span>,</span><br><span class="line">                    <span class="attr">esModule</span>:<span class="literal">false</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.html$/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;html-loader&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">exclude</span>:<span class="regexp">/\.(js|css|less|html|jpg|png|gif)$/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;file-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>:&#123;</span><br><span class="line">                    <span class="attr">outputPath</span>:<span class="string">&#x27;media&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            <span class="attr">filename</span>:<span class="string">&#x27;css/built.css&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> OptimizeCssAssetsWebpackPlugin(),</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span>,</span><br><span class="line">            <span class="attr">minify</span>:&#123;</span><br><span class="line">                <span class="attr">collapseWhitespace</span>:<span class="literal">true</span>,</span><br><span class="line">                <span class="attr">removeComments</span>:<span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;name&quot;</span>: <span class="string">&quot;webpack&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;main&quot;</span>: <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    	<span class="attr">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  	&#125;,</span><br><span class="line">  	<span class="attr">&quot;author&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;license&quot;</span>: <span class="string">&quot;ISC&quot;</span>,</span><br><span class="line">  	<span class="attr">&quot;devDependencies&quot;</span>: &#123;...&#125;,</span><br><span class="line">  	<span class="attr">&quot;browserslist&quot;</span>:&#123;</span><br><span class="line">    	<span class="comment">// 开发环境</span></span><br><span class="line">    	<span class="attr">&quot;development&quot;</span>:[</span><br><span class="line">        	<span class="string">&quot;last 1 chrome version&quot;</span>,</span><br><span class="line">        	<span class="string">&quot;last 1 firefox version&quot;</span>,</span><br><span class="line">        	<span class="string">&quot;last 1 safari version&quot;</span>,</span><br><span class="line">    	],</span><br><span class="line">    	<span class="comment">// 生产环境(默认)</span></span><br><span class="line">    	<span class="attr">&quot;production&quot;</span>:[</span><br><span class="line">        	<span class="string">&quot;&gt;0.2%&quot;</span>,</span><br><span class="line">        	<span class="string">&quot;not dead&quot;</span>,</span><br><span class="line">        	<span class="string">&quot;not op_mini all&quot;</span></span><br><span class="line">    	]</span><br><span class="line">  	&#125;,</span><br><span class="line">    <span class="attr">&quot;eslintConfig&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;extends&quot;</span>:<span class="string">&quot;airbnb-base&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="四-Webpack性能优化"><a href="#四-Webpack性能优化" class="headerlink" title="四.Webpack性能优化"></a>四.Webpack性能优化</h2><h3 id="1-开发环境性能优化"><a href="#1-开发环境性能优化" class="headerlink" title="1.开发环境性能优化"></a>1.开发环境性能优化</h3><h4 id="1-HMR"><a href="#1-HMR" class="headerlink" title="(1) HMR"></a>(1) HMR</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	HMR:hot module replacement 热模块替换/模块热替换</span></span><br><span class="line"><span class="comment">	作用:一个模块发生变化，只会重新打包这一个模块，而不是打包所有，极大提升打包构建速度</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	样式文件:可以使用HMR功能，style-loader中实现了</span></span><br><span class="line"><span class="comment">	js文件:默认不能使用HMR功能</span></span><br><span class="line"><span class="comment">		解决:修改js代码，添加支持HMR功能的代码</span></span><br><span class="line"><span class="comment">		注意:HMR功能对js的处理，只能处理非入口js文件的其他文件</span></span><br><span class="line"><span class="comment">	html文件:默认不能使用HMR功能，同时会导致Html文件不能热更新(不用做HMR功能)</span></span><br><span class="line"><span class="comment">		解决:修改entry入口，将html文件引入</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:[<span class="string">&#x27;./src/index.js&#x27;</span>,<span class="string">&#x27;./src/index.html&#x27;</span>],</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,	<span class="comment">// 可以加文件夹js/built.js，即打包到build/js文件夹下</span></span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[</span><br><span class="line">    		&#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[<span class="string">&#x27;style-loader&#x27;</span>,<span class="string">&#x27;css-loader&#x27;</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.less$/</span>,</span><br><span class="line">                use:[<span class="string">&#x27;style-loader&#x27;</span>,<span class="string">&#x27;css-loader&#x27;</span>,<span class="string">&#x27;less-loader&#x27;</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;	</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.(jpg|png|gif)$/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>:&#123;</span><br><span class="line">                    <span class="attr">limit</span>:<span class="number">8</span>*<span class="number">1024</span>,</span><br><span class="line">                    <span class="attr">esModule</span>:<span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">name</span>:<span class="string">&#x27;[hash:10].[ext]&#x27;</span>,</span><br><span class="line">                    <span class="comment">// outputPath属性，在目标文件夹下再创建一个文件夹</span></span><br><span class="line">                    <span class="attr">outputPath</span>:<span class="string">&#x27;img&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.html$/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;html-loader&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">exclude</span>:<span class="regexp">/\.(css|less|js|html|jpg|png|gif)$/</span>,</span><br><span class="line">                loader:<span class="string">&#x27;file-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>:&#123;</span><br><span class="line">                    <span class="attr">outputPath</span>:<span class="string">&#x27;media&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    	]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">devServer</span>:&#123;</span><br><span class="line">        <span class="attr">contentBase</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>),</span><br><span class="line">        <span class="attr">compress</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">port</span>:<span class="number">3000</span>,</span><br><span class="line">        <span class="attr">open</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 开启HMR功能</span></span><br><span class="line">    	<span class="attr">hot</span>:<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-source-map"><a href="#2-source-map" class="headerlink" title="(2) source-map"></a>(2) source-map</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	source-map:一种提供 源代码到构建后代码映射 的技术</span></span><br><span class="line"><span class="comment">				如果构建后代码出错了，通过映射关系可以追踪到源代码错误</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:[...],</span><br><span class="line">    <span class="attr">output</span>:&#123;...&#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">    	<span class="attr">rules</span>:[...]</span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[...],</span><br><span class="line">    <span class="attr">devServer</span>:&#123;...&#125;</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">   	<span class="attr">devtool</span>:<span class="string">&#x27;source-map&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	有以下几个参数</span></span><br><span class="line"><span class="comment">	[inline-|hidden-|eval-][nosources-][cheap-[module-]]source-map</span></span><br><span class="line"><span class="comment">	如:devtool:&#x27;inline-source-map&#x27;</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	source-map:外部</span></span><br><span class="line"><span class="comment">		提示错误代码准确信息 和 源代码的错误位置</span></span><br><span class="line"><span class="comment">	inline-source-map:内联(只生成一个内联source-map)</span></span><br><span class="line"><span class="comment">		提示错误代码准确信息 和 源代码的错误位置</span></span><br><span class="line"><span class="comment">		和普通source-map功能一致，只是source-map生成位置不同</span></span><br><span class="line"><span class="comment">	hidden-source-map:外部</span></span><br><span class="line"><span class="comment">		提示错误代码错误原因 和 构建后代码的错误位置</span></span><br><span class="line"><span class="comment">		不能追踪到源代码错误</span></span><br><span class="line"><span class="comment">	eval-source-map:内联(每一个文件都生成对应的source-map,都在eval中)</span></span><br><span class="line"><span class="comment">		提示错误代码准确信息 和 源代码的错误位置</span></span><br><span class="line"><span class="comment">		多一个唯一标识</span></span><br><span class="line"><span class="comment">	nosources-source-map:外部</span></span><br><span class="line"><span class="comment">		提示错误代码准确信息，但是没有任何源代码信息</span></span><br><span class="line"><span class="comment">	cheap-source-map:外部	</span></span><br><span class="line"><span class="comment">		提示错误代码准确信息 和 源代码的错误位置</span></span><br><span class="line"><span class="comment">		但是提示的错误位置只能精确到行，不能精确到列</span></span><br><span class="line"><span class="comment">	cheap-module-source-map:外部</span></span><br><span class="line"><span class="comment">		提示错误代码准确信息 和 源代码的错误位置</span></span><br><span class="line"><span class="comment">		module会将loader的source-map加入</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">	内联和外部的区别:</span></span><br><span class="line"><span class="comment">		1. 外部生成了.map文件，内联没有</span></span><br><span class="line"><span class="comment">		2. 内联构建速度更快</span></span><br><span class="line"><span class="comment">	开发环境:速度快，调试更友好</span></span><br><span class="line"><span class="comment">		速度快(eval&gt;inline&gt;cheap&gt;...)</span></span><br><span class="line"><span class="comment">			eval-cheap-source-map</span></span><br><span class="line"><span class="comment">			eval-source-map</span></span><br><span class="line"><span class="comment">		调试更友好</span></span><br><span class="line"><span class="comment">			source-map(inline-source-map/eval-source-map)</span></span><br><span class="line"><span class="comment">			cheap-module-souce-map</span></span><br><span class="line"><span class="comment">			cheap-source-map</span></span><br><span class="line"><span class="comment">		综合:eval-source-map</span></span><br><span class="line"><span class="comment">	生产环境:源代码要不要隐藏?调试要不要更友好?</span></span><br><span class="line"><span class="comment">		内联会让体积变得非常大，所以生产环境不用内联</span></span><br><span class="line"><span class="comment">		调试角度:source-map/cheap-module-source-map</span></span><br><span class="line"><span class="comment">		隐藏源代码:hidden-source-map/nosources-source-map</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h3 id="2-生产环境性能优化"><a href="#2-生产环境性能优化" class="headerlink" title="2.生产环境性能优化"></a>2.生产环境性能优化</h3><h4 id="1-oneOf-缓存-tree-shaking"><a href="#1-oneOf-缓存-tree-shaking" class="headerlink" title="(1) oneOf/缓存/tree shaking"></a>(1) oneOf/缓存/tree shaking</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	缓存:</span></span><br><span class="line"><span class="comment">		babel缓存</span></span><br><span class="line"><span class="comment">			cacheDirectory:true</span></span><br><span class="line"><span class="comment">			--&gt;让第二次打包构建速度更快</span></span><br><span class="line"><span class="comment">		文件资源缓存</span></span><br><span class="line"><span class="comment">			hash:每次webpack构建时会生成一个唯一的hash值</span></span><br><span class="line"><span class="comment">			问题:因为js和css同时使用一个hash值。如果重新打包，会导致所有缓存失效</span></span><br><span class="line"><span class="comment">			chunkhash:根据chunk生成的hash值，如果打包来源于同一个chunk，那么hash值一样</span></span><br><span class="line"><span class="comment">			问题:js和css的hash值还是一样的,因为css是在js中被引入的，所以同属于一个chunk</span></span><br><span class="line"><span class="comment">			contenthash:根据文件的内容生成hash值。不同文件hash值一定不同，并且单独管理</span></span><br><span class="line"><span class="comment">			--&gt;让代码上线运行缓存更好使用</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	tree shaking:去除无用代码</span></span><br><span class="line"><span class="comment">		前提:1.必须使用es6模块化 2.开启production环境</span></span><br><span class="line"><span class="comment">		作用:减少代码体积</span></span><br><span class="line"><span class="comment">		在package.json中配置</span></span><br><span class="line"><span class="comment">			&quot;sideEffects&quot;:false 所有代码都没有副作用(都可以进行tree shaking)</span></span><br><span class="line"><span class="comment">			问题:可能会把css文件等文件干掉</span></span><br><span class="line"><span class="comment">			解决:&quot;sideEffects&quot;:[&quot;*.css&quot;]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/built.[contenthash:10].js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>:&#123;</span><br><span class="line">        <span class="attr">rules</span>:[</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>:<span class="regexp">/\.js$/</span>,</span><br><span class="line">                exclude:<span class="regexp">/node_modules/</span>,</span><br><span class="line">                enforce:<span class="string">&#x27;pre&#x27;</span>,</span><br><span class="line">                <span class="attr">loader</span>:<span class="string">&#x27;eslint-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>:&#123;</span><br><span class="line">                	<span class="attr">fix</span>:<span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 以下loader只会匹配一个,匹配到后就不再进行匹配</span></span><br><span class="line">                <span class="comment">// 注意:不能有两个配置处理同一种类型文件</span></span><br><span class="line">                <span class="comment">//		如果相同文件，可提取到oneOf之外</span></span><br><span class="line">                <span class="attr">oneOf</span>:[</span><br><span class="line">                    &#123;</span><br><span class="line">                		<span class="attr">test</span>:<span class="regexp">/.css$/</span>,</span><br><span class="line">                		use:[...commonCssLoader]</span><br><span class="line">            		&#125;,</span><br><span class="line">            		&#123;</span><br><span class="line">                		<span class="attr">test</span>:<span class="regexp">/.less$/</span>,</span><br><span class="line">                		use:[...commonCssLoader,<span class="string">&#x27;less-loader&#x27;</span>]</span><br><span class="line">            		&#125;,</span><br><span class="line">            		&#123;</span><br><span class="line">                		<span class="attr">test</span>:<span class="regexp">/\.js$/</span>,</span><br><span class="line">                		exclude:<span class="regexp">/node_modules/</span>,</span><br><span class="line">                		loader:<span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">                		<span class="attr">options</span>:&#123;</span><br><span class="line">                    		<span class="attr">presets</span>:[</span><br><span class="line">                        		[</span><br><span class="line">                            		<span class="string">&#x27;@babel/preset-env&#x27;</span>,</span><br><span class="line">                         			&#123;</span><br><span class="line">                                		<span class="attr">useBuiltIns</span>:<span class="string">&#x27;usage&#x27;</span>,</span><br><span class="line">                                		<span class="attr">corejs</span>:&#123;<span class="attr">version</span>:<span class="number">3</span>&#125;,</span><br><span class="line">                                		<span class="attr">targets</span>:&#123;</span><br><span class="line">                                    		<span class="attr">chrome</span>:<span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">                                    		<span class="attr">firefox</span>:<span class="string">&#x27;50&#x27;</span></span><br><span class="line">                                		&#125;</span><br><span class="line">                            		&#125;</span><br><span class="line">                        		]</span><br><span class="line">                    		],</span><br><span class="line">                            <span class="comment">// 开启babel缓存</span></span><br><span class="line">                            <span class="comment">// 第二次构建时，会读取之前的缓存</span></span><br><span class="line">                            <span class="attr">cacheDirectory</span>:<span class="literal">true</span></span><br><span class="line">                		&#125;</span><br><span class="line">            		&#125;,</span><br><span class="line">            		&#123;</span><br><span class="line">                		<span class="attr">test</span>:<span class="regexp">/\.(jpg|png|gif)$/</span>,</span><br><span class="line">                		loader:<span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">                		<span class="attr">options</span>:&#123;</span><br><span class="line">                    		<span class="attr">limit</span>:<span class="number">8</span>*<span class="number">1024</span>,</span><br><span class="line">                    		<span class="attr">name</span>:<span class="string">&#x27;[hash:10].[ext]&#x27;</span>,</span><br><span class="line">                    		<span class="attr">outputPath</span>:<span class="string">&#x27;imgs&#x27;</span>,</span><br><span class="line">                    		<span class="attr">esModule</span>:<span class="literal">false</span></span><br><span class="line">                		&#125;</span><br><span class="line">            		&#125;,</span><br><span class="line">            		&#123;</span><br><span class="line">                		<span class="attr">test</span>:<span class="regexp">/\.html$/</span>,</span><br><span class="line">                		loader:<span class="string">&#x27;html-loader&#x27;</span></span><br><span class="line">            		&#125;,</span><br><span class="line">            		&#123;</span><br><span class="line">                		<span class="attr">exclude</span>:<span class="regexp">/\.(js|css|less|html|jpg|png|gif)$/</span>,</span><br><span class="line">                		loader:<span class="string">&#x27;file-loader&#x27;</span>,</span><br><span class="line">                		<span class="attr">options</span>:&#123;</span><br><span class="line">                    		<span class="attr">outputPath</span>:<span class="string">&#x27;media&#x27;</span></span><br><span class="line">                		&#125;</span><br><span class="line">            		&#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[...],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-代码分割"><a href="#2-代码分割" class="headerlink" title="(2) 代码分割"></a>(2) 代码分割</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="comment">// 单入口</span></span><br><span class="line">    <span class="comment">// entry:&#x27;./src/index.js&#x27;</span></span><br><span class="line">    <span class="attr">entry</span>:&#123;</span><br><span class="line">        <span class="comment">// 多入口:有一个入口，最终输出就有一个bundle</span></span><br><span class="line">        <span class="attr">index</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">        <span class="attr">test</span>:<span class="string">&#x27;./src/test.js&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="comment">// [name]:取文件名</span></span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/[name].[contenthash:10].js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[...],</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    	1.可以将node_modules中代码单独打包一个chunk最终输出</span></span><br><span class="line"><span class="comment">    	2.自动分析多入口chunk中有没有公共的文件。如果有会打包成单独一个chunk</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="attr">optimization</span>:&#123;</span><br><span class="line">        <span class="attr">splitChunks</span>:&#123;</span><br><span class="line">            <span class="attr">chunks</span>:<span class="string">&#x27;all&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-懒加载-预加载"><a href="#3-懒加载-预加载" class="headerlink" title="(3) 懒加载/预加载"></a>(3) 懒加载/预加载</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;index.js文件被加载&#x27;</span>)</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;btn&#x27;</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">/* lazy loading:懒加载 </span></span><br><span class="line"><span class="comment">    		当文件需要时才加载</span></span><br><span class="line"><span class="comment">    	prefetch:预加载</span></span><br><span class="line"><span class="comment">    		会在使用之前，提前加载js文件</span></span><br><span class="line"><span class="comment">    	正常加载可以认为是并行加载(同一时间加载多个文件)</span></span><br><span class="line"><span class="comment">    	预加载等其他资源加载完毕，浏览器空闲了再偷偷加载。(兼容性差，慎用)</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="comment">// 动态引入会单独打包成一个chunk</span></span><br><span class="line">    <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: &#x27;test&#x27;, webpackPrefetch:true */</span><span class="string">&#x27;./test&#x27;</span>)</span><br><span class="line">    	.then(<span class="function">(<span class="params">&#123;ml&#125;</span>)=&gt;</span>&#123;</span><br><span class="line">        	<span class="built_in">console</span>.log(ml(<span class="number">4</span>,<span class="number">5</span>))</span><br><span class="line">    	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-PWA-渐进式网络开发应用程序"><a href="#4-PWA-渐进式网络开发应用程序" class="headerlink" title="(4) PWA(渐进式网络开发应用程序)"></a>(4) PWA(渐进式网络开发应用程序)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	PWA:渐进式网络开发应用程序(离线可访问)</span></span><br><span class="line"><span class="comment">		workbox --&gt; workbox-webpack-plugin</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> WorkboxWebpackPlugin= <span class="built_in">require</span>(<span class="string">&#x27;workbox-webpack-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="attr">plugins</span>:[</span><br><span class="line">    <span class="keyword">new</span> WorkboxWebpackPlugin.GenerateSW(&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	1.帮助serviceworker快速启动</span></span><br><span class="line"><span class="comment">        	2.删除旧的serviceworker</span></span><br><span class="line"><span class="comment">        	生成一个serviceworker配置文件</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="attr">clientsClaim</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">skipWaiting</span>:<span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 以下代码在入口文件中使用 */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	会有几个问题:</span></span><br><span class="line"><span class="comment">	1.eslint不认识window、navigator全局变量</span></span><br><span class="line"><span class="comment">		解决:需要修改package.json中eslintConfig配置</span></span><br><span class="line"><span class="comment">			&quot;env&quot;:&#123;</span></span><br><span class="line"><span class="comment">				&quot;browser&quot;:true // 支持浏览器端全局变量</span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment">	2.sw代码必须运行在服务器上</span></span><br><span class="line"><span class="comment">		--&gt; nodejs</span></span><br><span class="line"><span class="comment">		--&gt; npm i serve -g</span></span><br><span class="line"><span class="comment">			serve -s [要运行代码的目录] </span></span><br><span class="line"><span class="comment">			如:serve -s build，将Build目录下所有资源作为静态资源暴露出去</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;serviceworker&#x27;</span> <span class="keyword">in</span> navigator)&#123;</span><br><span class="line">	<span class="built_in">window</span>.addEventListener(<span class="string">&#x27;load&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        navigator.serviceworker.register(<span class="string">&#x27;/service-worker.js&#x27;</span>)</span><br><span class="line">        .then(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;sw注册成功&#x27;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;sw注册失败&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-多进程打包"><a href="#5-多进程打包" class="headerlink" title="(5) 多进程打包"></a>(5) 多进程打包</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一般给babel-loader用</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">test</span>:<span class="regexp">/\.js$/</span>,</span><br><span class="line">    exclude:<span class="regexp">/node_modules/</span>,</span><br><span class="line">    use:[</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	开启多进程打包(慎用)</span></span><br><span class="line"><span class="comment">        	进程启动大概600ms，进程通信也有开销</span></span><br><span class="line"><span class="comment">        	只有工作消耗时间比较长，才使用多进程打包</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="string">&#x27;thread-loader&#x27;</span>,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">loader</span>:<span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">            <span class="attr">options</span>:&#123;</span><br><span class="line">                <span class="attr">presets</span>:[</span><br><span class="line">					[</span><br><span class="line">                    	<span class="string">&#x27;@babel/preset-env&#x27;</span>,</span><br><span class="line">                     	&#123;</span><br><span class="line">                     		<span class="attr">useBuiltIns</span>:<span class="string">&#x27;usage&#x27;</span>,</span><br><span class="line">                     		<span class="attr">corejs</span>:&#123;<span class="attr">version</span>:<span class="number">3</span>&#125;,</span><br><span class="line">                     		<span class="attr">targets</span>:&#123;</span><br><span class="line">                     			<span class="attr">chrome</span>:<span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">                     			<span class="attr">firefox</span>:<span class="string">&#x27;50&#x27;</span></span><br><span class="line">                     		&#125;</span><br><span class="line">                     	&#125;</span><br><span class="line">                     ]</span><br><span class="line">            	],</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-externals"><a href="#6-externals" class="headerlink" title="(6) externals"></a>(6) externals</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span></span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">    <span class="attr">externals</span>:&#123;</span><br><span class="line">        <span class="comment">// 拒绝jQuery被打包进来</span></span><br><span class="line">        <span class="comment">// 当忽略对应的包后，需要用cdn引入</span></span><br><span class="line">        <span class="attr">jquery</span>:<span class="string">&#x27;jQuery&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-dll"><a href="#7-dll" class="headerlink" title="(7) dll"></a>(7) dll</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	使用dll技术，对某些库(第三方库:jquery、react、vue...)进行单独打包</span></span><br><span class="line"><span class="comment">	当运行webpack时，默认查找webpack.config.js配置文件</span></span><br><span class="line"><span class="comment">	需求:需要运行新的配置文件webpack.dll.js文件</span></span><br><span class="line"><span class="comment">		--&gt; webpack --config webpack.dll.js</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 以下是一个新的配置文件 */</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:&#123;</span><br><span class="line">        <span class="comment">// 最终打包生成的[name] --&gt; jquery</span></span><br><span class="line">        <span class="comment">// [&#x27;jquery&#x27;] --&gt; 要打包的库是jquery</span></span><br><span class="line">        <span class="attr">jquery</span>:[<span class="string">&#x27;jquery&#x27;</span>]</span><br><span class="line">    &#125;，</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">    	<span class="attr">filename</span>:<span class="string">&#x27;[name].js&#x27;</span>,</span><br><span class="line">    	<span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;dll&#x27;</span>),</span><br><span class="line">        <span class="attr">library</span>:<span class="string">&#x27;[name]_[hash]&#x27;</span>,	<span class="comment">// 打包的库里面向外暴露出去的内容叫什么名字</span></span><br><span class="line">	&#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="comment">// 打包生成一个mainfest.json --&gt; 提供和jquery映射</span></span><br><span class="line">        <span class="keyword">new</span> webpack.Dllplugin(&#123;</span><br><span class="line">            <span class="attr">name</span>:<span class="string">&#x27;[name]_[hash]&#x27;</span>,	<span class="comment">// 映射库的暴露的内容名称</span></span><br><span class="line">            <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;dll/manifest.json&#x27;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 以下是webpack.config.js */</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> AddAssetHtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;add-asset-html-webpack-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span></span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;js/built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:resolve(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">template</span>:<span class="string">&#x27;./src/index.html&#x27;</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">// 告诉webpack哪些库不参与打包,同时使用时的名称也得改</span></span><br><span class="line">        <span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</span><br><span class="line">            <span class="attr">mainfest</span>:resolve(__dirname,<span class="string">&#x27;dll/manifest.json&#x27;</span>)</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">// 将某个文件打包输出去，并在Html自动引入该资源</span></span><br><span class="line">        <span class="keyword">new</span> AddAssetHtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="attr">filepath</span>:resolve(__dirname,<span class="string">&#x27;dll/jquery.js&#x27;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-性能优化总结"><a href="#3-性能优化总结" class="headerlink" title="3.性能优化总结"></a>3.性能优化总结</h3><p>webpack性能优化：</p>
<ul>
<li>开发环境性能优化</li>
<li>生产环境性能优化</li>
</ul>
<h4 id="开发环境性能优化"><a href="#开发环境性能优化" class="headerlink" title="开发环境性能优化"></a>开发环境性能优化</h4><ul>
<li><p>优化代码构建速度</p>
<ul>
<li>HMR</li>
</ul>
</li>
<li><p>优化代码调试</p>
<ul>
<li>source-map</li>
</ul>
</li>
</ul>
<h4 id="生产环境性能优化"><a href="#生产环境性能优化" class="headerlink" title="生产环境性能优化"></a>生产环境性能优化</h4><ul>
<li>优化打包构建速度</li>
<li>优化代码运行的性能</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/01/24/webpack/" data-id="ckys1yae50001xkvm3z1a5tyz" data-title="webpack" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2022/01/24/axios/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">axios</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/01/24/webpack/">webpack</a>
          </li>
        
          <li>
            <a href="/2022/01/24/axios/">axios</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 LonelyTaker<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>